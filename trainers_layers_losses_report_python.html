<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Technical Documentation Team">
<meta name="dcterms.date" content="2025-08-27">

<title>Energy GNN Technical Architecture Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="trainers_layers_losses_report_python_files/libs/clipboard/clipboard.min.js"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-html/popper.min.js"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-html/anchor.min.js"></script>
<link href="trainers_layers_losses_report_python_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="trainers_layers_losses_report_python_files/libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="trainers_layers_losses_report_python_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="trainers_layers_losses_report_python_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="trainers_layers_losses_report_python_files/libs/bootstrap/bootstrap-e52c317b831d71bd0833fd401c29266f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="trainers_layers_losses_report_python_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="trainers_layers_losses_report_python_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="trainers_layers_losses_report_python_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script type="text/javascript">
window.PlotlyConfig = {MathJaxConfig: 'local'};
if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
if (typeof require !== 'undefined') {
require.undef("plotly");
requirejs.config({
    paths: {
        'plotly': ['https://cdn.plot.ly/plotly-2.35.2.min']
    }
});
require(['plotly'], function(Plotly) {
    window._Plotly = Plotly;
});
}
</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary">Executive Summary</a>
  <ul class="collapse">
  <li><a href="#system-highlights" id="toc-system-highlights" class="nav-link" data-scroll-target="#system-highlights">System Highlights</a></li>
  </ul></li>
  <li><a href="#system-architecture-overview" id="toc-system-architecture-overview" class="nav-link" data-scroll-target="#system-architecture-overview">1. System Architecture Overview</a></li>
  <li><a href="#training-systems-analysis" id="toc-training-systems-analysis" class="nav-link" data-scroll-target="#training-systems-analysis">2. Training Systems Analysis</a>
  <ul class="collapse">
  <li><a href="#discovery-trainer-discovery_trainer.py" id="toc-discovery-trainer-discovery_trainer.py" class="nav-link" data-scroll-target="#discovery-trainer-discovery_trainer.py">2.1 Discovery Trainer (<code>discovery_trainer.py</code>)</a></li>
  <li><a href="#network-aware-trainer-network_aware_trainer.py" id="toc-network-aware-trainer-network_aware_trainer.py" class="nav-link" data-scroll-target="#network-aware-trainer-network_aware_trainer.py">2.2 Network-Aware Trainer (<code>network_aware_trainer.py</code>)</a></li>
  <li><a href="#unified-trainer-unified_gnn_trainer.py" id="toc-unified-trainer-unified_gnn_trainer.py" class="nav-link" data-scroll-target="#unified-trainer-unified_gnn_trainer.py">2.3 Unified Trainer (<code>unified_gnn_trainer.py</code>)</a></li>
  <li><a href="#enhanced-trainer-with-uncertainty-enhanced_trainer.py" id="toc-enhanced-trainer-with-uncertainty-enhanced_trainer.py" class="nav-link" data-scroll-target="#enhanced-trainer-with-uncertainty-enhanced_trainer.py">2.4 Enhanced Trainer with Uncertainty (<code>enhanced_trainer.py</code>)</a></li>
  </ul></li>
  <li><a href="#layer-architectures" id="toc-layer-architectures" class="nav-link" data-scroll-target="#layer-architectures">3. Layer Architectures</a>
  <ul class="collapse">
  <li><a href="#complementarity-attention-layer" id="toc-complementarity-attention-layer" class="nav-link" data-scroll-target="#complementarity-attention-layer">3.1 Complementarity Attention Layer</a></li>
  <li><a href="#physics-constraint-layers" id="toc-physics-constraint-layers" class="nav-link" data-scroll-target="#physics-constraint-layers">3.2 Physics Constraint Layers</a></li>
  <li><a href="#temporal-processing-layers" id="toc-temporal-processing-layers" class="nav-link" data-scroll-target="#temporal-processing-layers">3.3 Temporal Processing Layers</a></li>
  <li><a href="#hierarchical-pooling-layers" id="toc-hierarchical-pooling-layers" class="nav-link" data-scroll-target="#hierarchical-pooling-layers">3.4 Hierarchical Pooling Layers</a></li>
  </ul></li>
  <li><a href="#loss-functions-analysis" id="toc-loss-functions-analysis" class="nav-link" data-scroll-target="#loss-functions-analysis">4. Loss Functions Analysis</a>
  <ul class="collapse">
  <li><a href="#complementarity-loss" id="toc-complementarity-loss" class="nav-link" data-scroll-target="#complementarity-loss">4.1 Complementarity Loss</a></li>
  <li><a href="#energy-balance-loss" id="toc-energy-balance-loss" class="nav-link" data-scroll-target="#energy-balance-loss">4.2 Energy Balance Loss</a></li>
  <li><a href="#peak-reduction-loss" id="toc-peak-reduction-loss" class="nav-link" data-scroll-target="#peak-reduction-loss">4.3 Peak Reduction Loss</a></li>
  <li><a href="#unified-loss-function" id="toc-unified-loss-function" class="nav-link" data-scroll-target="#unified-loss-function">4.4 Unified Loss Function</a></li>
  </ul></li>
  <li><a href="#training-strategies" id="toc-training-strategies" class="nav-link" data-scroll-target="#training-strategies">5. Training Strategies</a>
  <ul class="collapse">
  <li><a href="#optimization-techniques" id="toc-optimization-techniques" class="nav-link" data-scroll-target="#optimization-techniques">5.1 Optimization Techniques</a></li>
  <li><a href="#learning-rate-scheduling" id="toc-learning-rate-scheduling" class="nav-link" data-scroll-target="#learning-rate-scheduling">5.2 Learning Rate Scheduling</a></li>
  <li><a href="#training-pipeline-integration" id="toc-training-pipeline-integration" class="nav-link" data-scroll-target="#training-pipeline-integration">5.3 Training Pipeline Integration</a></li>
  </ul></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics">6. Performance Metrics</a>
  <ul class="collapse">
  <li><a href="#key-performance-indicators" id="toc-key-performance-indicators" class="nav-link" data-scroll-target="#key-performance-indicators">6.1 Key Performance Indicators</a></li>
  <li><a href="#training-convergence-analysis" id="toc-training-convergence-analysis" class="nav-link" data-scroll-target="#training-convergence-analysis">6.2 Training Convergence Analysis</a></li>
  </ul></li>
  <li><a href="#component-interactions" id="toc-component-interactions" class="nav-link" data-scroll-target="#component-interactions">7. Component Interactions</a>
  <ul class="collapse">
  <li><a href="#information-flow" id="toc-information-flow" class="nav-link" data-scroll-target="#information-flow">7.1 Information Flow</a></li>
  <li><a href="#trainer-layer-loss-relationships" id="toc-trainer-layer-loss-relationships" class="nav-link" data-scroll-target="#trainer-layer-loss-relationships">7.2 Trainer-Layer-Loss Relationships</a></li>
  </ul></li>
  <li><a href="#innovation-highlights" id="toc-innovation-highlights" class="nav-link" data-scroll-target="#innovation-highlights">8. Innovation Highlights</a>
  <ul class="collapse">
  <li><a href="#key-innovations" id="toc-key-innovations" class="nav-link" data-scroll-target="#key-innovations">8.1 Key Innovations</a></li>
  <li><a href="#comparison-with-baselines" id="toc-comparison-with-baselines" class="nav-link" data-scroll-target="#comparison-with-baselines">8.2 Comparison with Baselines</a></li>
  </ul></li>
  <li><a href="#implementation-guidelines" id="toc-implementation-guidelines" class="nav-link" data-scroll-target="#implementation-guidelines">9. Implementation Guidelines</a>
  <ul class="collapse">
  <li><a href="#configuration-examples" id="toc-configuration-examples" class="nav-link" data-scroll-target="#configuration-examples">9.1 Configuration Examples</a></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices">9.2 Best Practices</a></li>
  </ul></li>
  <li><a href="#conclusions-and-future-work" id="toc-conclusions-and-future-work" class="nav-link" data-scroll-target="#conclusions-and-future-work">10. Conclusions and Future Work</a>
  <ul class="collapse">
  <li><a href="#summary-of-achievements" id="toc-summary-of-achievements" class="nav-link" data-scroll-target="#summary-of-achievements">10.1 Summary of Achievements</a></li>
  <li><a href="#performance-summary" id="toc-performance-summary" class="nav-link" data-scroll-target="#performance-summary">10.2 Performance Summary</a></li>
  <li><a href="#future-directions" id="toc-future-directions" class="nav-link" data-scroll-target="#future-directions">10.3 Future Directions</a></li>
  <li><a href="#code-repository-structure" id="toc-code-repository-structure" class="nav-link" data-scroll-target="#code-repository-structure">10.4 Code Repository Structure</a></li>
  </ul></li>
  <li><a href="#appendix-technical-details" id="toc-appendix-technical-details" class="nav-link" data-scroll-target="#appendix-technical-details">Appendix: Technical Details</a>
  <ul class="collapse">
  <li><a href="#a.-loss-function-formulations" id="toc-a.-loss-function-formulations" class="nav-link" data-scroll-target="#a.-loss-function-formulations">A. Loss Function Formulations</a></li>
  <li><a href="#b.-attention-mechanism-details" id="toc-b.-attention-mechanism-details" class="nav-link" data-scroll-target="#b.-attention-mechanism-details">B. Attention Mechanism Details</a></li>
  <li><a href="#c.-computational-complexity" id="toc-c.-computational-complexity" class="nav-link" data-scroll-target="#c.-computational-complexity">C. Computational Complexity</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Energy GNN Technical Architecture Report</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Comprehensive Analysis of Trainers, Layer Architectures, and Loss Functions</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Technical Documentation Team </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="executive-summary" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>The Energy GNN system represents a sophisticated graph neural network architecture designed for optimizing energy communities through advanced pattern discovery, network-aware training, and physics-constrained learning. This report provides a comprehensive technical analysis of the system’s three core components:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key Components Analyzed
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Training Systems</strong>: 6 specialized trainers for different optimization objectives</li>
<li><strong>Layer Architectures</strong>: 8 custom GNN layers for energy-specific operations<br>
</li>
<li><strong>Loss Functions</strong>: 7 physics-aware loss components ensuring realistic solutions</li>
</ol>
</div>
</div>
<section id="system-highlights" class="level3">
<h3 class="anchored" data-anchor-id="system-highlights">System Highlights</h3>
<ul>
<li><strong>Multi-objective Optimization</strong>: Simultaneously optimizes complementarity patterns, network constraints, and energy efficiency</li>
<li><strong>Hierarchical Architecture</strong>: Processes building → LV group → transformer → substation relationships</li>
<li><strong>Physics-Constrained Learning</strong>: Ensures all solutions respect energy conservation laws and grid limitations</li>
<li><strong>Intervention Loop</strong>: Active learning through simulated interventions with cascade effect tracking</li>
</ul>
<hr>
</section>
</section>
<section id="system-architecture-overview" class="level2">
<h2 class="anchored" data-anchor-id="system-architecture-overview">1. System Architecture Overview</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#ff9900', 'primaryTextColor':'#000', 'primaryBorderColor':'#7C0000', 'lineColor':'#5c5c5c', 'secondaryColor':'#006100', 'tertiaryColor':'#fff'}}}%%

graph TB
    subgraph Input["Input Layer"]
        BD[Building Data&lt;br/&gt;17 Features]
        TF[Temporal Profiles&lt;br/&gt;96 Timesteps]
        GS[Grid Structure&lt;br/&gt;Edge Index]
        KG[Knowledge Graph&lt;br/&gt;Constraints]
    end
    
    subgraph Trainers["Training Systems"]
        DT[Discovery Trainer&lt;br/&gt;Unsupervised]
        NT[Network-Aware Trainer&lt;br/&gt;Constrained]
        UT[Unified Trainer&lt;br/&gt;Multi-task]
        ET[Enhanced Trainer&lt;br/&gt;Uncertainty]
        CT[Contrastive Trainer&lt;br/&gt;Self-supervised]
        AT[Active Trainer&lt;br/&gt;Query-based]
    end
    
    subgraph Layers["GNN Layers"]
        CA[Complementarity&lt;br/&gt;Attention]
        TL[Temporal&lt;br/&gt;Processing]
        PL[Physics&lt;br/&gt;Constraints]
        NL[Network-Aware&lt;br/&gt;Layers]
        PO[Hierarchical&lt;br/&gt;Pooling]
        DG[Dynamic Graph&lt;br/&gt;Evolution]
        SS[Semi-Supervised&lt;br/&gt;Learning]
        EX[Explainability&lt;br/&gt;Module]
    end
    
    subgraph Losses["Loss Functions"]
        CL[Complementarity&lt;br/&gt;Loss]
        EL[Energy Balance&lt;br/&gt;Loss]
        PR[Peak Reduction&lt;br/&gt;Loss]
        SF[Self-Sufficiency&lt;br/&gt;Loss]
        QL[Cluster Quality&lt;br/&gt;Loss]
        NI[Network Impact&lt;br/&gt;Loss]
        CP[Cascade Prediction&lt;br/&gt;Loss]
    end
    
    subgraph Output["Output Layer"]
        EC[Energy Communities&lt;br/&gt;Clusters]
        IF[Intervention&lt;br/&gt;Recommendations]
        CF[Cascade Effects&lt;br/&gt;Predictions]
        EM[Energy Metrics&lt;br/&gt;Analysis]
    end
    
    BD --&gt; DT
    TF --&gt; DT
    GS --&gt; DT
    KG --&gt; NT
    
    DT --&gt; CA
    NT --&gt; NL
    UT --&gt; PL
    ET --&gt; SS
    CT --&gt; DG
    AT --&gt; EX
    
    CA --&gt; CL
    TL --&gt; EL
    PL --&gt; PR
    NL --&gt; NI
    PO --&gt; QL
    DG --&gt; CP
    SS --&gt; SF
    
    CL --&gt; EC
    NI --&gt; IF
    CP --&gt; CF
    SF --&gt; EM
    
    style Input fill:#e6f2ff
    style Trainers fill:#fff0e6
    style Layers fill:#e6ffe6
    style Losses fill:#ffe6e6
    style Output fill:#f0e6ff
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
<section id="training-systems-analysis" class="level2">
<h2 class="anchored" data-anchor-id="training-systems-analysis">2. Training Systems Analysis</h2>
<section id="discovery-trainer-discovery_trainer.py" class="level3">
<h3 class="anchored" data-anchor-id="discovery-trainer-discovery_trainer.py">2.1 Discovery Trainer (<code>discovery_trainer.py</code>)</h3>
<p>The <strong>DiscoveryGNNTrainer</strong> implements unsupervised pattern discovery without requiring ground truth labels, making it ideal for exploratory analysis of energy communities.</p>
<section id="key-features" class="level4">
<h4 class="anchored" data-anchor-id="key-features">Key Features</h4>
<div id="cell-discovery-features" class="cell" data-execution_count="2">
<div id="discovery-features" class="cell-output cell-output-display">
<div>                            <div id="2db266ff-46e5-498f-a3d3-9ae2684f9ea7" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2db266ff-46e5-498f-a3d3-9ae2684f9ea7")) {                    Plotly.newPlot(                        "2db266ff-46e5-498f-a3d3-9ae2684f9ea7",                        [{"cells":{"align":"left","fill":{"color":"lavender"},"font":{"size":11},"values":[["Data Loading","DiffPool Clustering","Physics Extraction","Loss Calculation","Optimization","Validation"],["Load building features","Hierarchical clustering","Extract demand\u002fgeneration","Complementarity + Physics","AdamW + Cosine LR","Self-sufficiency metrics"],["Batched graphs","Soft assignments","Energy profiles","Loss components","Updated weights","Performance metrics"]]},"header":{"align":"left","fill":{"color":"paleturquoise"},"font":{"size":12},"values":["Component","Process","Output"]},"type":"table"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"margin":{"l":0,"r":0,"t":40,"b":0},"title":{"text":"Discovery Trainer Pipeline Components"},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2db266ff-46e5-498f-a3d3-9ae2684f9ea7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Discovery Trainer Components and Workflow</p>
</div>
</div>
</section>
<section id="mathematical-formulation" class="level4">
<h4 class="anchored" data-anchor-id="mathematical-formulation">Mathematical Formulation</h4>
<p>The discovery loss combines multiple objectives:</p>
<p><span class="math display">\[\mathcal{L}_{discovery} = \alpha_{comp} \mathcal{L}_{comp} + \alpha_{phys} \mathcal{L}_{phys} + \alpha_{qual} \mathcal{L}_{qual} + \alpha_{peak} \mathcal{L}_{peak}\]</span></p>
<p>Where: - <span class="math inline">\(\alpha_{comp} = 2.0\)</span>: Complementarity weight (negative correlation) - <span class="math inline">\(\alpha_{phys} = 1.0\)</span>: Physics constraint weight - <span class="math inline">\(\alpha_{qual} = 1.5\)</span>: Clustering quality weight<br>
- <span class="math inline">\(\alpha_{peak} = 1.0\)</span>: Peak reduction weight</p>
</section>
<section id="code-example" class="level4">
<h4 class="anchored" data-anchor-id="code-example">Code Example</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DiscoveryGNNTrainer:</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_epoch(<span class="va">self</span>, train_loader):</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Train for one epoch with discovery objectives"""</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch <span class="kw">in</span> train_loader:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass with DiffPool</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            predictions <span class="op">=</span> <span class="va">self</span>._forward_with_diffpool(batch)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            physics_data <span class="op">=</span> <span class="va">self</span>._extract_physics_data(batch)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate unsupervised loss</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            loss, components <span class="op">=</span> <span class="va">self</span>.criterion(predictions, physics_data, batch)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add auxiliary DiffPool loss</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'aux_loss'</span> <span class="kw">in</span> predictions:</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> loss <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> predictions[<span class="st">'aux_loss'</span>]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Optimization step</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.zero_grad()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            torch.nn.utils.clip_grad_norm_(<span class="va">self</span>.model.parameters(), <span class="fl">1.0</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.step()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="network-aware-trainer-network_aware_trainer.py" class="level3">
<h3 class="anchored" data-anchor-id="network-aware-trainer-network_aware_trainer.py">2.2 Network-Aware Trainer (<code>network_aware_trainer.py</code>)</h3>
<p>The <strong>NetworkAwareGNNTrainer</strong> incorporates multi-hop network effects and intervention loops, demonstrating value beyond simple correlation.</p>
<section id="intervention-loop-architecture" class="level4">
<h4 class="anchored" data-anchor-id="intervention-loop-architecture">Intervention Loop Architecture</h4>
<div id="cell-intervention-loop" class="cell" data-execution_count="3">
<div id="intervention-loop" class="cell-output cell-output-display">
<div>                            <div id="55b5cca2-a949-44c8-b36e-e9c845ef9d72" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("55b5cca2-a949-44c8-b36e-e9c845ef9d72")) {                    Plotly.newPlot(                        "55b5cca2-a949-44c8-b36e-e9c845ef9d72",                        [{"hovertemplate":"Step=Select\u003cbr\u003eRound=%{x}\u003cbr\u003eNumber of Nodes Affected=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Select","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines+markers","name":"Select","orientation":"v","showlegend":true,"x":[1,2,3],"xaxis":"x","y":[5,8,10],"yaxis":"y","type":"scatter"},{"hovertemplate":"Step=Simulate\u003cbr\u003eRound=%{x}\u003cbr\u003eNumber of Nodes Affected=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Simulate","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines+markers","name":"Simulate","orientation":"v","showlegend":true,"x":[1,2,3],"xaxis":"x","y":[15,25,35],"yaxis":"y","type":"scatter"},{"hovertemplate":"Step=Update\u003cbr\u003eRound=%{x}\u003cbr\u003eNumber of Nodes Affected=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Update","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines+markers","name":"Update","orientation":"v","showlegend":true,"x":[1,2,3],"xaxis":"x","y":[15,25,35],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Round"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Number of Nodes Affected"}},"legend":{"title":{"text":"Step"},"tracegroupgap":0},"title":{"text":"Intervention Loop: Cascade Effects Growth"},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('55b5cca2-a949-44c8-b36e-e9c845ef9d72');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Network-Aware Training: Intervention Loop Process</p>
</div>
</div>
</section>
<section id="multi-hop-value-demonstration" class="level4">
<h4 class="anchored" data-anchor-id="multi-hop-value-demonstration">Multi-Hop Value Demonstration</h4>
<p>The trainer tracks cascade effects through the network:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_interventions(<span class="va">self</span>, selected_nodes, data, network_state):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simulate cascade effects up to 3 hops"""</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    cascade_effects <span class="op">=</span> {}</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> selected_nodes:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        cascade <span class="op">=</span> <span class="va">self</span>.simulator.calculate_cascade_effects(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            intervention<span class="op">=</span>{<span class="st">'building_id'</span>: node, <span class="st">'type'</span>: <span class="st">'solar'</span>},</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            network_state<span class="op">=</span>network_state,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            edge_index<span class="op">=</span>data.edge_index,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            max_hops<span class="op">=</span><span class="dv">3</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aggregate effects by hop distance</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> hop_key, effects <span class="kw">in</span> cascade.items():</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            cascade_effects[hop_key] <span class="op">=</span> {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_impact'</span>: accumulated_impact,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'congestion_relief'</span>: reduced_congestion,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">'economic_value'</span>: total_value</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="unified-trainer-unified_gnn_trainer.py" class="level3">
<h3 class="anchored" data-anchor-id="unified-trainer-unified_gnn_trainer.py">2.3 Unified Trainer (<code>unified_gnn_trainer.py</code>)</h3>
<p>Combines multiple objectives in a single training framework:</p>
<div id="cell-unified-objectives" class="cell" data-execution_count="4">
<div id="unified-objectives" class="cell-output cell-output-display">
<div>                            <div id="cea9a318-046d-4d62-b804-65ddf85faa62" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cea9a318-046d-4d62-b804-65ddf85faa62")) {                    Plotly.newPlot(                        "cea9a318-046d-4d62-b804-65ddf85faa62",                        [{"fill":"toself","name":"Optimization Objectives","r":[0.85,0.72,0.68,0.75,0.8],"theta":["Complementarity","Physics","Peak Reduction","Self-Sufficiency","Cluster Quality"],"type":"scatterpolar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"polar":{"radialaxis":{"visible":true,"range":[0,1]}},"title":{"text":"Multi-Objective Optimization Performance"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cea9a318-046d-4d62-b804-65ddf85faa62');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Unified Trainer: Multi-Objective Optimization Balance</p>
</div>
</div>
</section>
<section id="enhanced-trainer-with-uncertainty-enhanced_trainer.py" class="level3">
<h3 class="anchored" data-anchor-id="enhanced-trainer-with-uncertainty-enhanced_trainer.py">2.4 Enhanced Trainer with Uncertainty (<code>enhanced_trainer.py</code>)</h3>
<p>Incorporates advanced features: - <strong>Semi-supervised learning</strong> with pseudo-labels - <strong>Uncertainty quantification</strong> via Monte Carlo dropout - <strong>Explainability</strong> through attention visualization - <strong>Active learning</strong> for strategic data collection</p>
<hr>
</section>
</section>
<section id="layer-architectures" class="level2">
<h2 class="anchored" data-anchor-id="layer-architectures">3. Layer Architectures</h2>
<section id="complementarity-attention-layer" class="level3">
<h3 class="anchored" data-anchor-id="complementarity-attention-layer">3.1 Complementarity Attention Layer</h3>
<p>The <strong>ComplementarityAttention</strong> layer learns to identify and leverage negative correlation patterns between buildings.</p>
<section id="architecture-details" class="level4">
<h4 class="anchored" data-anchor-id="architecture-details">Architecture Details</h4>
<div id="cell-attention-architecture" class="cell" data-execution_count="5">
<div id="attention-architecture" class="cell-output cell-output-display">
<div>                            <div id="53bcbc6b-bf75-42e0-ab01-0180eb4e61b0" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("53bcbc6b-bf75-42e0-ab01-0180eb4e61b0")) {                    Plotly.newPlot(                        "53bcbc6b-bf75-42e0-ab01-0180eb4e61b0",                        [{"line":{"color":"blue"},"mode":"lines+markers","name":"Building A","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1.0,1.2588190451025207,1.5,1.7071067811865475,1.8660254037844386,1.9659258262890682,2.0,1.9659258262890682,1.8660254037844388,1.7071067811865475,1.5,1.258819045102521,1.0000000000000002,0.7411809548974793,0.5000000000000002,0.29289321881345287,0.13397459621556151,0.03407417371093169,0.0,0.03407417371093158,0.1339745962155614,0.2928932188134523,0.49999999999999956,0.7411809548974784],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"red"},"mode":"lines+markers","name":"Building B","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.0,0.03407417371093169,0.1339745962155614,0.2928932188134524,0.5,0.7411809548974793,1.0,1.2588190451025207,1.5,1.7071067811865475,1.8660254037844386,1.9659258262890682,2.0,1.9659258262890682,1.8660254037844388,1.7071067811865475,1.5,1.258819045102521,1.0000000000000002,0.7411809548974793,0.5000000000000002,0.29289321881345287,0.13397459621556151,0.03407417371093169],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"green","dash":"dash"},"mode":"lines","name":"Attention Weight","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.0066928509242848554,0.002185496499968708,0.0010795541402350841,0.0008486049627111873,0.0010795541402350841,0.002185496499968708,0.0066928509242848554,0.028317918542645707,0.13822314230008376,0.5,0.8617768576999161,0.9716820814573542,0.9933071490757153,0.9978145035000312,0.9989204458597649,0.9991513950372889,0.9989204458597649,0.9978145035000314,0.9933071490757153,0.9716820814573542,0.8617768576999162,0.5000000000000007,0.13822314230008423,0.028317918542645818],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0]},"yaxis":{"anchor":"x","domain":[0.625,1.0],"title":{"text":"Load (kW)"}},"xaxis2":{"anchor":"y2","domain":[0.0,1.0],"title":{"text":"Hour of Day"}},"yaxis2":{"anchor":"x2","domain":[0.0,0.375],"title":{"text":"Weight"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Complementary Load Profiles","x":0.5,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Correlation: -0.000","x":0.5,"xanchor":"center","xref":"paper","y":0.375,"yanchor":"bottom","yref":"paper"}],"height":600,"showlegend":true},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('53bcbc6b-bf75-42e0-ab01-0180eb4e61b0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Complementarity Attention Mechanism</p>
</div>
</div>
</section>
<section id="mathematical-formulation-1" class="level4">
<h4 class="anchored" data-anchor-id="mathematical-formulation-1">Mathematical Formulation</h4>
<p>The complementarity-aware attention score:</p>
<p><span class="math display">\[\alpha_{ij} = \text{softmax}\left(\frac{Q_i \cdot K_j}{\sqrt{d}} + \omega_{comp} \cdot (-\rho_{ij})\right)\]</span></p>
<p>Where: - <span class="math inline">\(Q_i, K_j\)</span>: Query and key projections - <span class="math inline">\(\rho_{ij}\)</span>: Correlation between temporal profiles - <span class="math inline">\(\omega_{comp}\)</span>: Complementarity weight</p>
</section>
</section>
<section id="physics-constraint-layers" class="level3">
<h3 class="anchored" data-anchor-id="physics-constraint-layers">3.2 Physics Constraint Layers</h3>
<p>Ensure physical feasibility of solutions:</p>
<div id="cell-physics-constraints" class="cell" data-execution_count="6">
<div id="physics-constraints" class="cell-output cell-output-display">
<div>                            <div id="24e43657-df38-4977-bd43-8b5d196dfbc8" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("24e43657-df38-4977-bd43-8b5d196dfbc8")) {                    Plotly.newPlot(                        "24e43657-df38-4977-bd43-8b5d196dfbc8",                        [{"marker":{"color":["red","orange","yellow","green","blue"]},"text":["Hard mask","Efficiency decay","Balance penalty","Ramp rate limit","Capacity check"],"textposition":"auto","x":["LV Group Boundary","Distance-Based Loss","Energy Balance","Temporal Consistency","Transformer Capacity"],"y":[10.0,1.0,5.0,3.0,8.0],"type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Physics Constraint Enforcement Mechanisms"},"xaxis":{"title":{"text":"Constraint Type"}},"yaxis":{"title":{"text":"Penalty Weight"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('24e43657-df38-4977-bd43-8b5d196dfbc8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Physics Constraint Enforcement</p>
</div>
</div>
<section id="lv-group-boundary-enforcement" class="level4">
<h4 class="anchored" data-anchor-id="lv-group-boundary-enforcement">LV Group Boundary Enforcement</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LVGroupBoundaryEnforcer(nn.Module):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, sharing_matrix, lv_group_ids):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Ensure energy sharing only within same LV group"""</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create mask for same LV group</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        lv_i <span class="op">=</span> lv_group_ids.unsqueeze(<span class="dv">2</span>)  <span class="co"># [B, N, 1]</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        lv_j <span class="op">=</span> lv_group_ids.unsqueeze(<span class="dv">1</span>)  <span class="co"># [B, 1, N]</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        same_lv_mask <span class="op">=</span> (lv_i <span class="op">==</span> lv_j).<span class="bu">float</span>()</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply hard constraint</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        masked_sharing <span class="op">=</span> sharing_matrix <span class="op">*</span> same_lv_mask</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate penalty for violations</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        violations <span class="op">=</span> sharing_matrix <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> same_lv_mask)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        boundary_penalty <span class="op">=</span> (violations <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> masked_sharing, boundary_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="temporal-processing-layers" class="level3">
<h3 class="anchored" data-anchor-id="temporal-processing-layers">3.3 Temporal Processing Layers</h3>
<p>Handle time-series dynamics:</p>
<div id="cell-temporal-layers" class="cell" data-execution_count="7">
<div id="temporal-layers" class="cell-output cell-output-display">
<div>                            <div id="350681e8-1675-4dab-8658-d18b94a52e48" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("350681e8-1675-4dab-8658-d18b94a52e48")) {                    Plotly.newPlot(                        "350681e8-1675-4dab-8658-d18b94a52e48",                        [{"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"x":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"y":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"z":[[1.0,0.8608983374260066,0.39467379209820297,0.6157451627682731,0.23271374852503546,0.04348762214346136,0.4385326601606583,0.39612940687253684,0.8745370745566682,0.12958439573979952,0.2223835301125653,0.22073090785444238,0.8140639827267196,0.09650017516583076,0.6769872310390659,0.2954366399462339,0.7008158400608475,0.7857685630415094,0.708805236042651,0.816173066071947,0.6628525829797696,0.98445531146064,0.9933373482539011,0.7837685253160124],[0.9507590576972849,1.0,0.5665830631683626,0.09013587846922888,0.4043292101258037,0.40760110220687007,0.37319799620932803,0.9401910128595198,0.26449020295480175,0.8596274146595889,0.9569803024895477,0.11151581523218679,0.7923675273052907,0.13312895368284483,0.32459016685448516,0.024163655455359034,0.7746355445385764,0.3472792850249111,0.6472786059228761,0.7603690616440808,0.9350968395221493,0.1407075111336149,0.4064311740869767,0.2955588757446749],[0.21783291007423045,0.8104282852946961,1.0,0.8761999320581287,0.6684532904454307,0.1664748768191291,0.6110247782433295,0.3268589103842714,0.97553554991797,0.553399433486799,0.4289834332839475,0.6524163392705025,0.21611725625080003,0.55870545672479,0.4801216596427996,0.22000418746285366,0.478932014557939,0.8682714020701646,0.7943506815201032,0.33735493371980196,0.5933715319786967,0.0381673172052337,0.5671999181096591,0.7283396776080193],[0.7820118889628604,0.9376285224016737,0.11766221104952279,1.0,0.8901140995301893,0.5960145323434488,0.5919021786312973,0.4428648049860239,0.11915582999541174,0.16165083532721392,0.4329156997323509,0.4832928372184513,0.008091278514835598,0.11931554465867289,0.45479760596501984,0.2671791620591868,0.9008280512620813,0.35492952757259366,0.41290409721718213,0.17981503007276467,0.6231828907559802,0.6914712977924394,0.21862401728423042,0.7197873726062924],[0.822615740050101,0.37174877474367074,0.47038904960773587,0.6363705881297568,1.0,0.30113258042649227,0.19461409044136857,0.26283929755632174,0.9210501325206749,0.3439278699037148,0.8692844633794982,0.48834899188716985,0.5743972153713848,0.4437554313953912,0.19861401500489495,0.45712699255685985,0.3720995258988312,0.941131877102201,0.860698081893627,0.34769780813763185,0.36917726664537154,0.11744723257949863,0.09528345631190427,0.03355711887148893],[0.23776181731967494,0.8007237680236802,0.46618682787659405,0.6364022528829381,0.3478512154210235,1.0,0.8953355846597247,0.5918288960449946,0.05880516900128008,0.8061427957995391,0.37885311500954233,0.8796989012129994,0.29018565149920317,0.4295560116877173,0.843750895680492,0.22188541961443897,0.06024086029160236,0.6185862442158412,0.2225760060006693,0.6087792706676578,0.8734006887536323,0.540572451523847,0.5205262400204466,0.34307346383877213],[0.6877064747433693,0.4935876615581789,0.010883112939703787,0.8316583949190577,0.2763525267407745,0.4630297206491477,1.0,0.4977155146451634,0.0817334563465425,0.6468224304370792,0.9710269625658082,0.4145508332852569,0.1890085311258608,0.3035127570242585,0.3861460147446345,0.7170989855532814,0.02121102499250238,0.8,0.8,0.8,0.3507884444939975,0.2524869281402685,0.22292683746101127,0.2740167263472256],[0.24133853918682868,0.6809534534933281,0.8864368099706299,0.7138334852557285,0.034207006029478126,0.8162084780697694,0.3840733292789159,1.0,0.8341727426643771,0.38368974231904684,0.7293964779409767,0.8138623110071196,0.0411799246993072,0.6130589399326553,0.3077575260790798,0.44628150327488125,0.6118934725617289,0.8,0.8,0.8,0.6930748683667614,0.27762746622447243,0.2753638736427888,0.362638533177008],[0.9840366045611119,0.7619249741312829,0.12244650087817388,0.2980763691938093,0.5269357885607182,0.37311110981001705,0.8192260025478166,0.6279593459623005,1.0,0.5807530149872754,0.5336974931499697,0.3145649780221508,0.9860329551159537,0.8747590744956796,0.6570513199434748,0.03319166798835227,0.9174361771416372,0.8,0.8,0.8,0.9749892565637962,0.6283098270244938,0.9815208024567308,0.20267785381697667],[0.6795233652141937,0.12027334847667182,0.442040765967165,0.7207706620390147,0.6493833458537093,0.8840930503935297,0.19194511301421047,0.12927964372593126,0.8607050557858107,1.0,0.3737782745118601,0.2703715063131523,0.39348664305310044,0.8704456908737855,0.3475790126049383,0.13256672741738906,0.5703120432771649,0.8875104113050887,0.43688725759276403,0.8112287382329652,0.8760401543408874,0.6571265049692032,0.21978894376096147,0.839515371264486],[0.8337227068597566,0.0903093457671823,0.48996233950538404,0.16080800579614007,0.2266263744597954,0.7762285410653665,0.41514417012314264,0.654338790269409,0.1351073284940183,0.23025366522138013,1.0,0.49595297839295993,0.8881123014724835,0.201625270416671,0.7351898937852496,0.6095040208363648,0.5884408172935689,0.055589499573682866,0.8957264234086094,0.7327907170085706,0.8186084295948798,0.896454344064323,0.8150261877688537,0.620907247465529],[0.8178015124173421,0.5509969541438524,0.5239221560832941,0.20743001790037163,0.9811584049533273,0.20576509717960034,0.8343502226470196,0.2665495614775829,0.4903583150564885,0.9115430016998743,0.024860029746162082,1.0,0.5806843867422371,0.009983366045928532,0.21455873347126542,0.22391170096642388,0.2959339403779043,0.22875156527267948,0.4240856488861283,0.19885428784865178,0.6206166647097384,0.9133941726370746,0.9338558312683797,0.30949874640629127],[0.8587382371081163,0.05483764555841353,0.20111210164823468,0.9264562259116874,0.7486337956364894,0.013118105599418062,0.4085141655577984,0.6179862517539231,0.560270184933764,0.3786990062905715,0.7236286733104792,0.43895569314580074,1.0,0.955751709776343,0.9453430807822422,0.5731831716119925,0.4026227150747944,0.7553515043565506,0.6472075500373685,0.9271480266999157,0.8852926151447016,0.5361334694061349,0.236784196830637,0.46738946125293934],[0.8771096154615825,0.6259086801155902,0.2778074343470214,0.7639524240276088,0.07968017391103199,0.6688643766378948,0.8984432597385579,0.2627654782351708,0.11178292429206027,0.013789193757457463,0.880507664053581,0.5832085414729586,0.7923425458705473,1.0,0.883836078648737,0.11240854694306834,0.7477065306031132,0.30010425113781336,0.01812519208420016,0.27931208760641435,0.11300217675422652,0.4028893917185762,0.9661858710604941,0.9673212685166707],[0.31358098716665783,0.21640240694934287,0.4970113330621653,0.7608380047692351,0.1457930584519005,0.012392356865989829,0.7266942036583328,0.7582358288604532,0.6992309522896706,0.2101895084619333,0.7342758158508017,0.966164563956447,0.6695451245077023,0.7535205329460596,1.0,0.05694911411008663,0.4849250741437411,0.6763245982749049,0.9346742002733278,0.9491231619603717,0.294388260277481,0.5448595261792295,0.7450049494508061,0.44266872875140884],[0.3600449962416661,0.7931231405368958,0.2502622497443333,0.4984695974247281,0.7050431269009223,0.5726868791770193,0.742404413090646,0.4423639728470149,0.6160665657477795,0.8650590665863739,0.878650374735377,0.001406151552687085,0.13060383769095052,0.44096308091640024,0.6201125951615308,1.0,0.7833067087434669,0.8915843001679833,0.09928343302558118,0.1775940718543748,0.8418658091458239,0.08720714601387214,0.4944824741891165,0.42642565125196563],[0.2585012011747494,0.19276392806103393,0.7119841574205008,0.7227799419293108,0.02471737578853883,0.9068595386011783,0.4061626965499734,0.9824119976661798,0.9687766530112589,0.7622338039634362,0.2795517208989935,0.6351366634743669,0.7575371935956965,0.11699688905427597,0.3015136719476872,0.8735314456123692,1.0,0.9736075123466961,0.39219769985561703,0.2261635991629044,0.4748142991573716,0.7405233117840478,0.5803907223125255,0.7943915854311165],[0.9329786023264193,0.07068869034918235,0.7483997431662328,0.5027640616862652,0.057863593476015995,0.119520955758601,0.8,0.8,0.8,0.36318040609945323,0.5531157656646606,0.09762498697587452,0.7004540855802647,0.5631102478410281,0.9739497600692956,0.7362601263493334,0.09364133358744708,1.0,0.03254109300341401,0.6084088782312285,0.7080946021620826,0.29278324134810507,0.5781539214354422,0.474666321515281],[0.8946535447501516,0.21155186433645867,0.6100186653579959,0.3629873614759621,0.5349645681770197,0.6026488701750256,0.8,0.8,0.8,0.2556670845609834,0.9595196670452799,0.20726225127221354,0.49440277498210505,0.8067246907444088,0.371789926486481,0.4356824122602123,0.9458106214602297,0.5592058815136374,1.0,0.04887490587374632,0.03847583914750363,0.05200510112318546,0.5526650009166058,0.9163448425144466],[0.0014937582747054368,0.3626193214531074,0.85026983134963,0.4579792270550702,0.29758349034386733,0.2848346588846221,0.8,0.8,0.8,0.8454268322639159,0.6552124810737807,0.8899332502249556,0.3426043882974701,0.7044242622736664,0.4066181190298227,0.07309983661111463,0.4375476594507899,0.4381977760842678,0.8422519283933343,1.0,0.8644310351681285,0.3036283673345933,0.1658338654075855,0.5228178067483938],[0.5360620205625134,0.11140186444911593,0.11913226925672316,0.7433524099527841,0.19115335164028624,0.5923358555457368,0.25518684294061444,0.1893454135776208,0.5926380737150396,0.6603511382161008,0.07362289374452557,0.8264366922722001,0.8579718920609877,0.7519630870251959,0.966773766102676,0.14988733280126054,0.12479669652492831,0.17366729260398417,0.3899104620214483,0.17510423409410514,1.0,0.8098627508884283,0.3899950109895409,0.01460699642411123],[0.8097712363048873,0.29802754904064344,0.7201258775836155,0.21153223188254022,0.5782135983423091,0.5989438646270292,0.8102207352935411,0.2244084673920721,0.34244505011796866,0.16486981519908717,0.05801555089501187,0.9869466857151561,0.34722626037657356,0.2696525630455324,0.42725355248763186,0.41767260777611426,0.7511955962979588,0.4546025887957942,0.6203531516153602,0.6477092993072646,0.6616509025729737,1.0,0.5250650270360699,0.8225904179168612],[0.9026981607339256,0.6272603009572917,0.7601987202181035,0.3860757115022271,0.08470913772496169,0.9949824838006825,0.7931609621112881,0.22691691707937145,0.6171037927648958,0.9612748716769351,0.25036296842529737,0.1521803406264045,0.8357752638831478,0.21028865245525497,0.8299661926682758,0.6404555075001928,0.9563846944142722,0.8733417572392681,0.01732430489359016,0.24833256637646084,0.5341992529930076,0.1411681013409426,1.0,0.6197570778501833],[0.3065928991759497,0.06195456560977386,0.896931180547075,0.24972279578393874,0.6162593163237936,0.65465376523675,0.8849636709643371,0.71679075713845,0.8304097131457818,0.06321364675964025,0.5024262165475223,0.9823592571178544,0.8644923554815939,0.3657044631304387,0.5866110518595126,0.9628051475878261,0.2765503580516404,0.06853290739573403,0.6044875895441563,0.9074352302189325,0.36087271728551207,0.12994344084365084,0.975210315492186,1.0]],"type":"heatmap"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Temporal Self-Attention Patterns"},"xaxis":{"title":{"text":"Target Time"}},"yaxis":{"title":{"text":"Source Time"}},"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('350681e8-1675-4dab-8658-d18b94a52e48');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Temporal Processing Architecture</p>
</div>
</div>
</section>
<section id="hierarchical-pooling-layers" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-pooling-layers">3.4 Hierarchical Pooling Layers</h3>
<p>Enable multi-resolution analysis:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    subgraph Building Level
        B1[Building 1]
        B2[Building 2]
        B3[Building 3]
        B4[Building 4]
        B5[Building 5]
        B6[Building 6]
    end
    
    subgraph LV Group Level
        L1[LV Group 1]
        L2[LV Group 2]
    end
    
    subgraph Transformer Level
        T1[Transformer]
    end
    
    B1 --&gt; L1
    B2 --&gt; L1
    B3 --&gt; L1
    B4 --&gt; L2
    B5 --&gt; L2
    B6 --&gt; L2
    L1 --&gt; T1
    L2 --&gt; T1
    
    style B1 fill:#e6f2ff
    style B2 fill:#e6f2ff
    style B3 fill:#e6f2ff
    style B4 fill:#e6f2ff
    style B5 fill:#e6f2ff
    style B6 fill:#e6f2ff
    style L1 fill:#fff0e6
    style L2 fill:#fff0e6
    style T1 fill:#ffe6e6
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="loss-functions-analysis" class="level2">
<h2 class="anchored" data-anchor-id="loss-functions-analysis">4. Loss Functions Analysis</h2>
<section id="complementarity-loss" class="level3">
<h3 class="anchored" data-anchor-id="complementarity-loss">4.1 Complementarity Loss</h3>
<p>Rewards negative correlation between clustered buildings:</p>
<div id="cell-complementarity-loss" class="cell" data-execution_count="8">
<div id="complementarity-loss" class="cell-output cell-output-display">
<div>                            <div id="85ddd05a-1a0d-428f-9dfd-668605f90fbc" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("85ddd05a-1a0d-428f-9dfd-668605f90fbc")) {                    Plotly.newPlot(                        "85ddd05a-1a0d-428f-9dfd-668605f90fbc",                        [{"line":{"color":"red","width":3},"mode":"lines","name":"Loss","x":[-1.0,-0.9797979797979798,-0.9595959595959596,-0.9393939393939394,-0.9191919191919192,-0.898989898989899,-0.8787878787878788,-0.8585858585858586,-0.8383838383838383,-0.8181818181818181,-0.797979797979798,-0.7777777777777778,-0.7575757575757576,-0.7373737373737373,-0.7171717171717171,-0.696969696969697,-0.6767676767676767,-0.6565656565656566,-0.6363636363636364,-0.6161616161616161,-0.5959595959595959,-0.5757575757575757,-0.5555555555555556,-0.5353535353535352,-0.5151515151515151,-0.4949494949494949,-0.4747474747474747,-0.4545454545454545,-0.43434343434343425,-0.41414141414141414,-0.3939393939393939,-0.3737373737373737,-0.3535353535353535,-0.33333333333333326,-0.31313131313131304,-0.2929292929292928,-0.2727272727272727,-0.2525252525252525,-0.23232323232323226,-0.21212121212121204,-0.19191919191919182,-0.1717171717171716,-0.1515151515151515,-0.13131313131313127,-0.11111111111111105,-0.09090909090909083,-0.07070707070707061,-0.050505050505050386,-0.030303030303030276,-0.010101010101010055,0.010101010101010166,0.030303030303030498,0.05050505050505061,0.07070707070707072,0.09090909090909105,0.11111111111111116,0.1313131313131315,0.1515151515151516,0.1717171717171717,0.19191919191919204,0.21212121212121215,0.2323232323232325,0.2525252525252526,0.27272727272727293,0.29292929292929304,0.31313131313131315,0.3333333333333335,0.3535353535353536,0.3737373737373739,0.39393939393939403,0.41414141414141437,0.4343434343434345,0.4545454545454546,0.4747474747474749,0.49494949494949503,0.5151515151515154,0.5353535353535355,0.5555555555555556,0.5757575757575759,0.595959595959596,0.6161616161616164,0.6363636363636365,0.6565656565656568,0.6767676767676769,0.696969696969697,0.7171717171717173,0.7373737373737375,0.7575757575757578,0.7777777777777779,0.7979797979797982,0.8181818181818183,0.8383838383838385,0.8585858585858588,0.8787878787878789,0.8989898989898992,0.9191919191919193,0.9393939393939394,0.9595959595959598,0.9797979797979799,1.0],"y":[0.0,0.02020202020202022,0.04040404040404044,0.06060606060606055,0.08080808080808077,0.101010101010101,0.12121212121212122,0.14141414141414144,0.16161616161616166,0.18181818181818188,0.202020202020202,0.2222222222222222,0.24242424242424243,0.26262626262626265,0.2828282828282829,0.303030303030303,0.3232323232323233,0.3434343434343434,0.36363636363636365,0.38383838383838387,0.4040404040404041,0.4242424242424243,0.4444444444444444,0.46464646464646475,0.48484848484848486,0.5050505050505051,0.5252525252525253,0.5454545454545455,0.5656565656565657,0.5858585858585859,0.6060606060606061,0.6262626262626263,0.6464646464646465,0.6666666666666667,0.686868686868687,0.7070707070707072,0.7272727272727273,0.7474747474747475,0.7676767676767677,0.787878787878788,0.8080808080808082,0.8282828282828284,0.8484848484848485,0.8686868686868687,0.888888888888889,0.9090909090909092,0.9292929292929294,0.9494949494949496,0.9696969696969697,0.98989898989899,1.0101010101010102,1.0303030303030305,1.0505050505050506,1.0707070707070707,1.090909090909091,1.1111111111111112,1.1313131313131315,1.1515151515151516,1.1717171717171717,1.191919191919192,1.2121212121212122,1.2323232323232325,1.2525252525252526,1.272727272727273,1.292929292929293,1.3131313131313131,1.3333333333333335,1.3535353535353536,1.373737373737374,1.393939393939394,1.4141414141414144,1.4343434343434345,1.4545454545454546,1.474747474747475,1.494949494949495,1.5151515151515154,1.5353535353535355,1.5555555555555556,1.575757575757576,1.595959595959596,1.6161616161616164,1.6363636363636365,1.6565656565656568,1.676767676767677,1.696969696969697,1.7171717171717173,1.7373737373737375,1.7575757575757578,1.777777777777778,1.7979797979797982,1.8181818181818183,1.8383838383838385,1.8585858585858588,1.878787878787879,1.8989898989898992,1.9191919191919193,1.9393939393939394,1.9595959595959598,1.97979797979798,2.0],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":0,"xref":"x","y0":0,"y1":1,"yref":"y domain"},{"line":{"color":"green","dash":"dash"},"type":"line","x0":-0.5,"x1":-0.5,"xref":"x","y0":0,"y1":1,"yref":"y domain"}],"annotations":[{"showarrow":false,"text":"No Correlation","x":0,"xanchor":"left","xref":"x","y":1,"yanchor":"top","yref":"y domain"},{"showarrow":false,"text":"Target","x":-0.5,"xanchor":"left","xref":"x","y":1,"yanchor":"top","yref":"y domain"}],"title":{"text":"Complementarity Loss vs Correlation"},"xaxis":{"title":{"text":"Correlation Coefficient"}},"yaxis":{"title":{"text":"Loss Value"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('85ddd05a-1a0d-428f-9dfd-668605f90fbc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Complementarity Loss Function Behavior</p>
</div>
</div>
<p>Mathematical formulation: <span class="math display">\[\mathcal{L}_{comp} = \frac{1}{|C|} \sum_{i,j \in C} (\rho_{ij} + 1) \cdot S_i^T S_j\]</span></p>
<p>Where: - <span class="math inline">\(\rho_{ij}\)</span>: Temporal correlation between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> - <span class="math inline">\(S\)</span>: Soft cluster assignment matrix - <span class="math inline">\(C\)</span>: Set of node pairs in same cluster</p>
</section>
<section id="energy-balance-loss" class="level3">
<h3 class="anchored" data-anchor-id="energy-balance-loss">4.2 Energy Balance Loss</h3>
<p>Ensures energy conservation within communities:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EnergyBalanceLoss(nn.Module):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _energy_balance_loss(<span class="va">self</span>, energy_sharing, consumption, generation):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Energy balance: consumption = generation + net_import"""</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        net_demand <span class="op">=</span> consumption <span class="op">-</span> generation</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        net_import <span class="op">=</span> energy_sharing.<span class="bu">sum</span>(dim<span class="op">=-</span><span class="dv">2</span>) <span class="op">-</span> energy_sharing.<span class="bu">sum</span>(dim<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        imbalance <span class="op">=</span> net_demand <span class="op">-</span> net_import</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (imbalance <span class="op">**</span> <span class="dv">2</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="peak-reduction-loss" class="level3">
<h3 class="anchored" data-anchor-id="peak-reduction-loss">4.3 Peak Reduction Loss</h3>
<div id="cell-peak-reduction" class="cell" data-execution_count="9">
<div id="peak-reduction" class="cell-output cell-output-display">
<div>                            <div id="eca7c8aa-4a75-425a-9be4-91eff1bd2ece" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eca7c8aa-4a75-425a-9be4-91eff1bd2ece")) {                    Plotly.newPlot(                        "eca7c8aa-4a75-425a-9be4-91eff1bd2ece",                        [{"mode":"lines","name":"Building 1","opacity":0.3,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.817673389764563,1.4931183440759024,0.9107773678553007,0.9953042369111577,1.6287233144547617,0.34682887656754147,0.6417786495690618,2.296170532173619,2.953967374705581,0.9005862578358902,1.3116812601999142,1.5526682113712025,0.8973342662765764,0.6143991796337664,0.8402810972745218,1.0276127070558718,1.3129176918827086,2.7185634059762096,2.776457204279162,3.1136771028452914,1.2353435991337582,1.1176008866050307,1.3318897203625315,1.4809984329970753],"type":"scatter"},{"mode":"lines","name":"Building 2","opacity":0.3,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.8062708093522233,0.6481803955206291,1.0719721069537513,0.896776224747753,1.0601419687397298,0.9990209841177216,1.1975520908862218,2.64064393147141,2.77297234951728,1.6085769772901384,0.5699567335940476,0.9221229216508406,0.43273688105489516,0.8432121065178289,1.097207029295483,0.9886761888141539,1.4241135233722846,2.9224446697544106,3.4003761721672374,3.3575699070566065,0.987246097368842,0.9003271590727359,0.9050599152981118,1.1828286328177169],"type":"scatter"},{"mode":"lines","name":"Building 3","opacity":0.3,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.6052012194211733,1.4758185972579347,0.983663569263826,0.47778397009759443,0.8823726627373928,0.9350360323324972,0.7830067984308665,2.5710179757140814,2.2340158139410065,0.8906274270965344,0.9314055004452284,1.4730096462264728,1.350471614359586,1.2628449415112797,0.8826483702804702,1.266168979540931,1.1058831091846668,2.988961202504035,2.665178872630009,3.04515118248089,0.8939741438429487,0.6310318452285055,0.8998756700571219,1.6742478225718114],"type":"scatter"},{"mode":"lines","name":"Building 4","opacity":0.3,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1.4539177877497904,1.64472747088421,0.8548893234653041,1.1135150581086672,0.7791401944715906,0.7276692240307472,1.4360423438104704,2.1169409606594263,2.8441761369653884,0.5804190588205491,0.6917409122759897,0.8170261397246631,0.8544222454666711,1.3972001432355414,1.1597654607578227,1.4718543669291666,1.1944912717332397,3.084568091574328,3.2002975878662605,3.9860729828546537,1.426273922000348,1.612086171405834,1.3506582571522205,0.881414425677006],"type":"scatter"},{"mode":"lines","name":"Building 5","opacity":0.3,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.9846547758308379,0.9930223553070193,0.6407230778153457,0.7833363639762064,1.1791244049934084,0.717415498325892,1.033162332032124,2.3221865344810384,2.697997053815085,0.6437466891041175,1.4572383622624305,0.9347705997636467,0.7123803398464554,0.7670332919491333,0.3871991343698179,1.0141497549586564,1.416349992526137,3.359491079420512,3.4913100827091537,3.0868543281377545,0.5408929279119707,1.1718828343703467,0.6914047435522173,0.8628149501569484],"type":"scatter"},{"line":{"color":"red","width":3},"mode":"lines","name":"Aggregated","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.9335435964237175,1.250973432609139,0.8924050890707056,0.8533431707682757,1.1059005090793765,0.7451941230748799,1.0183084429457487,2.389391986899915,2.7006257457888685,0.9247912820294459,0.9924045537555222,1.139919503747365,0.8494690694008369,0.9769379325695098,0.8734202183956231,1.1536923994597559,1.2907511177398074,3.014805689845899,3.1067239839303644,3.3178651006750393,1.0167461380515737,1.0865857793364906,1.0357776612844407,1.2164608528441119],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Peak Demand Reduction through Aggregation"},"xaxis":{"title":{"text":"Hour"}},"yaxis":{"title":{"text":"Demand (kW)"}},"height":400,"annotations":[{"bgcolor":"white","bordercolor":"black","showarrow":false,"text":"Peak Reduction: 16.8%","x":0.02,"xref":"paper","y":0.98,"yref":"paper"}]},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eca7c8aa-4a75-425a-9be4-91eff1bd2ece');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Peak Reduction Through Clustering</p>
</div>
</div>
</section>
<section id="unified-loss-function" class="level3">
<h3 class="anchored" data-anchor-id="unified-loss-function">4.4 Unified Loss Function</h3>
<p>Combines all objectives:</p>
<div id="cell-loss-composition" class="cell" data-execution_count="10">
<div id="loss-composition" class="cell-output cell-output-display">
<div>                            <div id="dafb0500-0878-477f-a487-1536ee3b78ec" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("dafb0500-0878-477f-a487-1536ee3b78ec")) {                    Plotly.newPlot(                        "dafb0500-0878-477f-a487-1536ee3b78ec",                        [{"customdata":[["Pattern"],["Constraint"],["Objective"],["Objective"],["Structure"]],"domain":{"x":[0.0,1.0],"y":[0.0,1.0]},"hovertemplate":"Component=%{label}\u003cbr\u003eWeight=%{value}\u003cbr\u003eCategory=%{customdata[0]}\u003cextra\u003e\u003c\u002fextra\u003e","labels":["Complementarity","Physics","Peak Reduction","Self-Sufficiency","Cluster Quality"],"legendgroup":"","marker":{"colors":["#636efa","#EF553B","#00cc96","#00cc96","#ab63fa"]},"name":"","showlegend":true,"values":[2.0,1.0,1.0,0.65,1.5],"type":"pie","textinfo":"percent+label","textposition":"inside"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"legend":{"tracegroupgap":0},"title":{"text":"Unified Loss Function Composition"},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('dafb0500-0878-477f-a487-1536ee3b78ec');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Loss Function Component Weights</p>
</div>
</div>
<hr>
</section>
</section>
<section id="training-strategies" class="level2">
<h2 class="anchored" data-anchor-id="training-strategies">5. Training Strategies</h2>
<section id="optimization-techniques" class="level3">
<h3 class="anchored" data-anchor-id="optimization-techniques">5.1 Optimization Techniques</h3>
<div id="cell-optimization-comparison" class="cell" data-execution_count="11">
<div id="optimization-comparison" class="cell-output cell-output-display">
<div>                            <div id="6f15bc76-aebc-41f7-a943-dfc6f5e817cf" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6f15bc76-aebc-41f7-a943-dfc6f5e817cf")) {                    Plotly.newPlot(                        "6f15bc76-aebc-41f7-a943-dfc6f5e817cf",                        [{"mode":"lines","name":"Adam","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[1.1161445344423584,1.087409903217604,0.9895176210235229,0.9780780085527604,0.8848193683823786,0.8424978761056113,0.8005124935340909,0.8439479211127303,0.792372422145748,0.7356985051320588,0.7215984829349802,0.655784981140106,0.668759821143766,0.6003886433948609,0.5713054277030477,0.583698158219899,0.5564690960005778,0.510338324703661,0.5234140272765906,0.4811573861177081,0.4797499878456745,0.48624478534799387,0.46634059838272757,0.35804060635082013,0.3911399539695209,0.38362426358738216,0.3766630351951278,0.32975735937741035,0.31907503289665917,0.3213307980541428,0.30557965561676015,0.2910597338324409,0.28105065089717446,0.2842722396996147,0.2863817718443232,0.29588999644109926,0.27930460668446816,0.2727633148241902,0.21642613179589665,0.28256473516973984,0.2441077951746008,0.2056191643822321,0.20280438892662034,0.23024771837017832,0.23885340204766065,0.22529920774547646,0.2107937778625304,0.21931469572613355,0.1815477553543711,0.19428844470515644,0.18531837456380257,0.18979272796210703,0.1914979721420203,0.15174112040885315,0.15512740328008184,0.15380364655036138,0.17817674634805047,0.1516719941299495,0.1124486730226874,0.15416162302410907,0.1244706998616569,0.15855845787392392,0.16303509292273147,0.10621924675371978,0.13444017808951014,0.15824048588379946,0.14784327221252097,0.13554129853901115,0.1464053543819903,0.12485436696333407,0.15809551085555668,0.11392615078601971,0.13733978053615212,0.12388745496607452,0.1227412144250662,0.10739700511455481,0.1218582791162129,0.15020856180789663,0.13431206712586372,0.10538187214210437,0.12081147069786526,0.12383001964807716,0.12071400264656829,0.06417208042041517,0.06613659973020958,0.132353073981618,0.1326287667725978,0.10932501985410968,0.08790519313527133,0.12719062531181521,0.07863060900689753,0.07680347137152403,0.10687754696976332,0.10845672446208916,0.14126658355712896,0.0895101421937644,0.09839845367166272,0.11900253647778956,0.07800230105035687,0.10817152423923801],"type":"scatter"},{"mode":"lines","name":"AdamW","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[1.09032722378625,1.0043771699847548,0.9325278495927883,0.9238345796161284,0.8435222009241742,0.7784784122907326,0.7635968485654399,0.7166203963645472,0.6559264898147432,0.6350401564451287,0.5753522374167074,0.5565376033471425,0.5289088680425095,0.5141337510312642,0.4837881221223476,0.45010205834682926,0.42661878810965864,0.37690332369639895,0.372634277338114,0.3553154205760776,0.3411143332550104,0.3285023754321212,0.29479201406522804,0.3290412085832806,0.28124402464652143,0.24981057104001786,0.2715444666787111,0.24893613102196643,0.22995545720551147,0.2271165935053415,0.19910826679429922,0.23230112964042707,0.18160829757689967,0.17426156374927143,0.18012515624440315,0.14364763225300053,0.15860996333618302,0.15315120298126345,0.1674060533933318,0.16433754924343588,0.12859228056175034,0.13364498149495968,0.12653207887915816,0.14764354352110742,0.12219553420801237,0.1466193418960944,0.1103789167073946,0.13116943877452386,0.1244753916704653,0.11460649180991411,0.13930097662154825,0.125644003111146,0.0953601598689804,0.09134271562277,0.11529837078611999,0.09260545320809824,0.11658069078092555,0.11456778129498615,0.10834088058542239,0.10127513451882525,0.07610714659385279,0.11349880846048666,0.07123761722398508,0.08925635890970021,0.09137266250482991,0.0794857605045053,0.0774373555038444,0.06980212308186023,0.07745020135175479,0.0936796528622694,0.10251490358076194,0.05454049116368737,0.08401931882456162,0.09006738839863673,0.09557226880340246,0.0833660379940937,0.07296578346082716,0.09074139137665489,0.10383206151184568,0.07143989734444414,0.05502806768921026,0.08310120461137482,0.07468941811421549,0.08041332893992557,0.09841203416059378,0.10979889075771686,0.10924023115065305,0.0805944058109994,0.06389622823652166,0.07485100339208332,0.09130650652603761,0.08794554967291818,0.07053116039123233,0.0711880875722298,0.0899577424734593,0.09885686502959956,0.09553804794423652,0.09046834315636244,0.056217749771855015,0.0941261480763593],"type":"scatter"},{"mode":"lines","name":"SGD","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[1.1401136903500764,1.12091928842092,1.0466199210106355,1.01100146624451,1.0401166491501999,0.9834730766769221,0.9457125439915665,0.9286476043249142,0.8882101744205365,0.8161766544395355,0.8364372138401887,0.8416497765777219,0.7850096824054746,0.760560772059577,0.772665601650475,0.7183687090953418,0.7350441584289032,0.6694101991949615,0.6685977767984586,0.6307004796066074,0.5672210993321525,0.6398541174271591,0.6010031281539195,0.5952363793977444,0.5451590095555283,0.5955918838318676,0.5740850686316279,0.5519991479370304,0.5614920761061292,0.5066943006585566,0.4684019344152251,0.457732838132274,0.47486103771338,0.4416010743110669,0.40973550562484107,0.4175693814046973,0.430427023845684,0.43891935997692494,0.3999427586716946,0.39802002126613034,0.4297435013264202,0.3598290054707189,0.3441710670447778,0.41320786805083626,0.31261504256235234,0.33406917795998403,0.36912932652991787,0.31768967003387216,0.3495807367443939,0.29212421239019515,0.3002305402915441,0.30039360492948924,0.3117376153099961,0.33448972356424594,0.29629279291990446,0.32217787962152766,0.2672488891148755,0.24426291761963928,0.25264311409212614,0.22766338376285278,0.2543411072051702,0.23776671889371997,0.2768495661555805,0.20784978170364166,0.2760541067414064,0.22763264066421915,0.2309951059845759,0.2533841609648069,0.2438709185690698,0.19398128623730976,0.2141363556780141,0.21147310052057486,0.21691525519867386,0.21068994051650972,0.2565026376909347,0.23376833785614037,0.2085320946643573,0.2563823681171946,0.17632271057645243,0.23451219170640827,0.20365832465019712,0.1542823010218872,0.15819122107615494,0.1624003525903203,0.14072707443230068,0.18620863802733711,0.18817746744021363,0.17883595159381951,0.198480755324283,0.1901378884910956,0.21095078048255983,0.14145470622868983,0.20107146445220636,0.10888967670985844,0.1905345541254247,0.1811724585001449,0.1521450519947107,0.13899769288841735,0.1683293873871409,0.19536246732495127],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Optimizer Convergence Comparison"},"xaxis":{"title":{"text":"Epoch"}},"yaxis":{"title":{"text":"Loss"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6f15bc76-aebc-41f7-a943-dfc6f5e817cf');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Optimizer Performance Comparison</p>
</div>
</div>
</section>
<section id="learning-rate-scheduling" class="level3">
<h3 class="anchored" data-anchor-id="learning-rate-scheduling">5.2 Learning Rate Scheduling</h3>
<div id="cell-lr-scheduling" class="cell" data-execution_count="12">
<div id="lr-scheduling" class="cell-output cell-output-display">
<div>                            <div id="5cb05188-4e1d-4a60-8850-700ee2b66a7a" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5cb05188-4e1d-4a60-8850-700ee2b66a7a")) {                    Plotly.newPlot(                        "5cb05188-4e1d-4a60-8850-700ee2b66a7a",                        [{"mode":"lines","name":"Cosine Annealing","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.001,0.0009997532801828658,0.0009990133642141358,0.00099778098230154,0.000996057350657239,0.0009938441702975688,0.0009911436253643444,0.0009879583809693738,0.0009842915805643156,0.0009801468428384716,0.0009755282581475768,0.0009704403844771128,0.0009648882429441257,0.0009588773128419905,0.0009524135262330098,0.0009455032620941839,0.0009381533400219318,0.0009303710135019718,0.0009221639627510075,0.0009135402871372809,0.0009045084971874737,0.0008950775061878452,0.0008852566213878947,0.0008750555348152298,0.0008644843137107057,0.0008535533905932737,0.0008422735529643444,0.0008306559326618259,0.0008187119948743449,0.0008064535268264883,0.0007938926261462367,0.0007810416889260654,0.0007679133974894983,0.0007545207078751857,0.0007408768370508576,0.0007269952498697733,0.0007128896457825364,0.0006985739453173903,0.0006840622763423391,0.0006693689601226458,0.0006545084971874737,0.0006394955530196147,0.0006243449435824273,0.0006090716206982714,0.0005936906572928624,0.0005782172325201155,0.0005626666167821522,0.0005470541566592571,0.0005313952597646568,0.0005157053795390641,0.0005,0.00048429462046093585,0.0004686047402353433,0.00045294584334074284,0.00043733338321784795,0.0004217827674798846,0.0004063093427071377,0.0003909283793017289,0.00037565505641757257,0.0003605044469803854,0.00034549150281252644,0.0003306310398773543,0.00031593772365766116,0.00030142605468260966,0.00028711035421746366,0.00027300475013022663,0.0002591231629491423,0.00024547929212481435,0.00023208660251050156,0.00021895831107393465,0.00020610737385376348,0.00019354647317351172,0.00018128800512565513,0.00016934406733817414,0.00015772644703565563,0.00014644660940672628,0.00013551568628929433,0.00012494446518477025,0.00011474337861210544,0.00010492249381215479,9.549150281252633e-05,8.645971286271919e-05,7.783603724899258e-05,6.962898649802813e-05,6.184665997806821e-05,5.449673790581611e-05,4.758647376699032e-05,4.112268715800954e-05,3.5111757055874326e-05,2.9559615522887274e-05,2.4471741852423235e-05,1.9853157161528523e-05,1.5708419435684518e-05,1.2041619030626338e-05,8.856374635655639e-06,6.15582970243117e-06,3.942649342761117e-06,2.219017698460002e-06,9.866357858642206e-07,2.467198171342e-07],"type":"scatter"},{"mode":"lines","name":"Reduce on Plateau","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.0005,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.00025,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125,0.000125],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"yaxis":{"title":{"text":"Learning Rate"},"type":"log"},"title":{"text":"Learning Rate Scheduling Strategies"},"xaxis":{"title":{"text":"Epoch"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5cb05188-4e1d-4a60-8850-700ee2b66a7a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Learning Rate Schedule Strategies</p>
</div>
</div>
</section>
<section id="training-pipeline-integration" class="level3">
<h3 class="anchored" data-anchor-id="training-pipeline-integration">5.3 Training Pipeline Integration</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">sequenceDiagram
    participant D as Data Loader
    participant T as Trainer
    participant M as Model
    participant L as Loss Functions
    participant O as Optimizer
    participant V as Validator
    
    D-&gt;&gt;T: Batch of graphs
    T-&gt;&gt;M: Forward pass
    M-&gt;&gt;M: Attention layers
    M-&gt;&gt;M: Physics constraints
    M-&gt;&gt;M: Pooling/Clustering
    M-&gt;&gt;T: Predictions
    T-&gt;&gt;L: Calculate losses
    L-&gt;&gt;L: Complementarity
    L-&gt;&gt;L: Energy balance
    L-&gt;&gt;L: Peak reduction
    L-&gt;&gt;T: Total loss
    T-&gt;&gt;O: Backward pass
    O-&gt;&gt;M: Update weights
    T-&gt;&gt;V: Validate
    V-&gt;&gt;T: Metrics
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="performance-metrics" class="level2">
<h2 class="anchored" data-anchor-id="performance-metrics">6. Performance Metrics</h2>
<section id="key-performance-indicators" class="level3">
<h3 class="anchored" data-anchor-id="key-performance-indicators">6.1 Key Performance Indicators</h3>
<div id="cell-kpi-dashboard" class="cell" data-execution_count="13">
<div id="kpi-dashboard" class="cell-output cell-output-display">
<div>                            <div id="a03cc67c-5069-4ec2-962b-8e5fbbb25a4a" class="plotly-graph-div" style="height:600px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a03cc67c-5069-4ec2-962b-8e5fbbb25a4a")) {                    Plotly.newPlot(                        "a03cc67c-5069-4ec2-962b-8e5fbbb25a4a",                        [{"domain":{"x":[0.0,0.45],"y":[0.625,1.0]},"gauge":{"axis":{"range":[null,100]},"bar":{"color":"darkgreen"},"threshold":{"thickness":0.75,"value":65}},"mode":"gauge+number","title":{"text":"Self-Sufficiency (%)"},"value":72,"type":"indicator"},{"domain":{"x":[0.55,1.0],"y":[0.625,1.0]},"gauge":{"axis":{"range":[null,50]},"bar":{"color":"blue"},"threshold":{"thickness":0.75,"value":25}},"mode":"gauge+number","title":{"text":"Peak Reduction (%)"},"value":28,"type":"indicator"},{"domain":{"x":[0.0,0.45],"y":[0.0,0.375]},"gauge":{"axis":{"range":[-1,1]},"bar":{"color":"purple"},"threshold":{"thickness":0.75,"value":-0.5}},"mode":"gauge+number","title":{"text":"Avg Correlation"},"value":-0.65,"type":"indicator"},{"domain":{"x":[0.55,1.0],"y":[0.0,0.375]},"gauge":{"axis":{"range":[null,100]},"bar":{"color":"orange"},"threshold":{"thickness":0.75,"value":90}},"mode":"gauge+number","title":{"text":"Network Efficiency (%)"},"value":94,"type":"indicator"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Self-Sufficiency","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Peak Reduction","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Complementarity Score","x":0.225,"xanchor":"center","xref":"paper","y":0.375,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Network Efficiency","x":0.775,"xanchor":"center","xref":"paper","y":0.375,"yanchor":"bottom","yref":"paper"}],"title":{"text":"Energy GNN Performance Metrics"},"height":600},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a03cc67c-5069-4ec2-962b-8e5fbbb25a4a');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>System Performance Dashboard</p>
</div>
</div>
</section>
<section id="training-convergence-analysis" class="level3">
<h3 class="anchored" data-anchor-id="training-convergence-analysis">6.2 Training Convergence Analysis</h3>
<div id="cell-convergence-analysis" class="cell" data-execution_count="14">
<div id="convergence-analysis" class="cell-output cell-output-display">
<div>                            <div id="51cf8fda-cf34-4e57-abfb-0ecfbd8e7a5f" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("51cf8fda-cf34-4e57-abfb-0ecfbd8e7a5f")) {                    Plotly.newPlot(                        "51cf8fda-cf34-4e57-abfb-0ecfbd8e7a5f",                        [{"line":{"width":2},"mode":"lines","name":"Complementarity","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],"y":[2.354211100064143,2.080187175247566,1.849740313993116,1.7725251730234066,1.5784660874872174,1.4854042638870157,1.386753875960108,1.3086511819664226,1.1033398493562783,1.0312358608753405,0.9941089400884564,0.9782223113357402,0.8197537877486236,0.8768128450985688,0.7648933514103872,0.7611255900982586,0.6393828879824776,0.5825873631623343,0.5989637343675845,0.7056459174233162,0.5500930022841246,0.5513494151666863,0.5196130085269506,0.4010378665004371,0.4047874438398634,0.3918449158923075,0.47524411166123337,0.4793854852518776,0.4507123235914246,0.41546343989950013,0.3895548649827246,0.41078528267826464,0.34956285844837975,0.3460487545462974,0.4317501069922249,0.317037204663014,0.32666236110898544,0.353391278078237,0.23814201806229474,0.36131810621082927,0.27626907156900166,0.4255227844816736,0.33130577333746414,0.32777719578187886,0.3153483455415263,0.28829977147045577,0.2927209049009613,0.3267162493080764,0.41756992493374545,0.3481884977141665],"type":"scatter"},{"line":{"width":2},"mode":"lines","name":"Physics","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],"y":[1.2158949166548176,1.1168720297523906,1.0663647356898167,0.9905369971567078,0.951113404926281,0.8440258010607156,0.8779942144917174,0.8513160100777628,0.752145748666055,0.7491621801925773,0.7104977847353737,0.7241477075667653,0.6382960853690434,0.662044104429125,0.5925187991610428,0.5859693830352704,0.591779285996701,0.45266544214918286,0.4773489883234353,0.47076890660064213,0.449104343491415,0.43469063368037575,0.4555518531487907,0.3952027340583537,0.39278091797171116,0.36699179048153174,0.34688277617574687,0.37657710554767676,0.3248184968077141,0.3265470086883855,0.3634768124182049,0.33227983980358916,0.30578235473062065,0.35094038354919543,0.3570964799916833,0.3521289747540886,0.32008199519334884,0.22340927653462161,0.32952246014049213,0.2823218489203505,0.2869305372559418,0.2545319176041314,0.24054595770555237,0.25620067858096135,0.2589311681003994,0.2282793631221447,0.21602214327657096,0.27028706723724705,0.19871474158442082,0.22636249216566645],"type":"scatter"},{"line":{"width":2},"mode":"lines","name":"Peak Reduction","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],"y":[0.911988980716608,0.8620881308469897,0.8327623430263653,0.7945507866181594,0.7214896635531735,0.686808305174772,0.6040719032182958,0.6069962242556809,0.5549411201859603,0.5202178997758392,0.47535222440107017,0.46807322739738966,0.4491252663693288,0.42937035334219165,0.4020759607661209,0.41520791817149016,0.385217256497689,0.3444625983360728,0.34463977148160946,0.284753467080423,0.3117476309295629,0.2567848676437399,0.281277454169992,0.25915780438338476,0.2562530978112749,0.2340981505147453,0.2574917126390688,0.24375084613141168,0.22273696172494897,0.20483778113645965,0.21491755365628049,0.16073351502748548,0.1721675922829981,0.19940395123531193,0.17907658314589153,0.18166580789013367,0.18027410973474292,0.2545052740530792,0.21109340986528088,0.1816088212769403,0.1920101345485305,0.14026102226680856,0.22100345019095313,0.15556171060549817,0.1848453814857134,0.1611287698138616,0.20330352022655537,0.1597059608912601,0.14215479330138972,0.19590303257455255],"type":"scatter"},{"line":{"dash":"dash","width":3},"mode":"lines","name":"Total","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49],"y":[1.4940316658118562,1.353049111948982,1.2496224642364326,1.1858709855994247,1.0836897186555572,1.0054127900408343,0.9562733312233739,0.922321138766622,0.8034755727360978,0.7668719802812524,0.7266529830749668,0.7234810820999651,0.6357250464956653,0.6560757676232951,0.586496037112517,0.587434297101673,0.5387931434922891,0.4599051345491966,0.47365083139087644,0.48705609703479374,0.4369816589017009,0.4142749721636007,0.41881410528191115,0.35179946831405856,0.35127381987428313,0.3309782856295282,0.3598728668253497,0.36657114564365534,0.3327559273746959,0.31561607657478175,0.3226497436857367,0.3012662125031131,0.27583760182066613,0.2987976964436016,0.3226410567099332,0.28361066243574545,0.27567282201235904,0.2771019428886459,0.2595859626893559,0.27508292546937335,0.2517365811244913,0.2734385747842045,0.2642850604113232,0.24651319498944613,0.253041631709213,0.22590263480215403,0.2373488561346959,0.2522364258121945,0.2528131532731853,0.25681800748479516],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Training Loss Convergence"},"xaxis":{"title":{"text":"Epoch"}},"yaxis":{"title":{"text":"Loss Value"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('51cf8fda-cf34-4e57-abfb-0ecfbd8e7a5f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Multi-Component Loss Convergence</p>
</div>
</div>
<hr>
</section>
</section>
<section id="component-interactions" class="level2">
<h2 class="anchored" data-anchor-id="component-interactions">7. Component Interactions</h2>
<section id="information-flow" class="level3">
<h3 class="anchored" data-anchor-id="information-flow">7.1 Information Flow</h3>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    subgraph Input Processing
        IF[Input Features] --&gt; TA[Temporal Attention]
        IF --&gt; CA[Complementarity Attention]
        IF --&gt; SA[Spatial Attention]
    end
    
    subgraph Core Processing
        TA --&gt; UAM[Unified Attention Module]
        CA --&gt; UAM
        SA --&gt; UAM
        UAM --&gt; PL[Physics Layers]
        PL --&gt; DP[DiffPool]
    end
    
    subgraph Output Generation
        DP --&gt; CL[Cluster Assignments]
        DP --&gt; EF[Energy Flows]
        CL --&gt; IM[Intervention Module]
        EF --&gt; IM
        IM --&gt; CP[Cascade Predictor]
    end
    
    style IF fill:#e6f2ff
    style UAM fill:#fff0e6
    style IM fill:#ffe6e6
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="trainer-layer-loss-relationships" class="level3">
<h3 class="anchored" data-anchor-id="trainer-layer-loss-relationships">7.2 Trainer-Layer-Loss Relationships</h3>
<div id="cell-component-relationships" class="cell" data-execution_count="15">
<div id="component-relationships" class="cell-output cell-output-display">
<div>                            <div id="2d64ad7d-c1b8-4a06-9b0a-a307c83eee59" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2d64ad7d-c1b8-4a06-9b0a-a307c83eee59")) {                    Plotly.newPlot(                        "2d64ad7d-c1b8-4a06-9b0a-a307c83eee59",                        [{"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"showscale":false,"text":[[1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,0,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,1,0,1,1,0,1,1]],"textfont":{"size":12},"texttemplate":"%{text}","x":["Attention","Temporal","Physics","Pooling","Complementarity","Balance","Peak","Quality","Network","Cascade","Uncertainty","Active"],"y":["Discovery","Network-Aware","Unified","Enhanced"],"z":[[1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,0,1,1,1,0],[1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,0,1,0,1,1,0,1,1]],"type":"heatmap"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"Trainer-Component Dependency Matrix"},"xaxis":{"title":{"text":"Components"}},"yaxis":{"title":{"text":"Trainers"}},"height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2d64ad7d-c1b8-4a06-9b0a-a307c83eee59');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Component Dependency Matrix</p>
</div>
</div>
<hr>
</section>
</section>
<section id="innovation-highlights" class="level2">
<h2 class="anchored" data-anchor-id="innovation-highlights">8. Innovation Highlights</h2>
<section id="key-innovations" class="level3">
<h3 class="anchored" data-anchor-id="key-innovations">8.1 Key Innovations</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Novel Contributions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Complementarity-Aware Attention</strong>: First GNN architecture explicitly designed to identify and leverage negative correlation patterns in energy consumption</p></li>
<li><p><strong>Multi-Hop Cascade Prediction</strong>: Tracks intervention effects through network topology up to 3 hops, quantifying indirect benefits</p></li>
<li><p><strong>Physics-Constrained Clustering</strong>: DiffPool variant that respects LV group boundaries and transformer capacity constraints</p></li>
<li><p><strong>Intervention Loop Training</strong>: Active learning through simulated interventions with real-world cascade tracking</p></li>
</ol>
</div>
</div>
</section>
<section id="comparison-with-baselines" class="level3">
<h3 class="anchored" data-anchor-id="comparison-with-baselines">8.2 Comparison with Baselines</h3>
<div id="cell-baseline-comparison" class="cell" data-execution_count="16">
<div id="baseline-comparison" class="cell-output cell-output-display">
<div>                            <div id="a3ab273d-f1a6-4d35-abd1-c4ca5e408d38" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a3ab273d-f1a6-4d35-abd1-c4ca5e408d38")) {                    Plotly.newPlot(                        "a3ab273d-f1a6-4d35-abd1-c4ca5e408d38",                        [{"alignmentgroup":"True","hovertemplate":"Metric=Self-Sufficiency\u003cbr\u003eMethod=%{x}\u003cbr\u003eValue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Self-Sufficiency","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"Self-Sufficiency","offsetgroup":"Self-Sufficiency","orientation":"v","showlegend":true,"textposition":"auto","x":["Random","Energy Label","Distance-Based","Correlation","GNN (Ours)"],"xaxis":"x","y":[45,52,48,58,72],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Metric=Peak Reduction\u003cbr\u003eMethod=%{x}\u003cbr\u003eValue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Peak Reduction","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"Peak Reduction","offsetgroup":"Peak Reduction","orientation":"v","showlegend":true,"textposition":"auto","x":["Random","Energy Label","Distance-Based","Correlation","GNN (Ours)"],"xaxis":"x","y":[12,15,14,18,28],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Metric=Network Impact\u003cbr\u003eMethod=%{x}\u003cbr\u003eValue=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Network Impact","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"Network Impact","offsetgroup":"Network Impact","orientation":"v","showlegend":true,"textposition":"auto","x":["Random","Energy Label","Distance-Based","Correlation","GNN (Ours)"],"xaxis":"x","y":[20,25,22,30,45],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Method"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Performance (%)"}},"legend":{"title":{"text":"Metric"},"tracegroupgap":0},"title":{"text":"Performance Comparison: GNN vs Baselines"},"barmode":"group","height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a3ab273d-f1a6-4d35-abd1-c4ca5e408d38');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Performance vs Traditional Methods</p>
</div>
</div>
<hr>
</section>
</section>
<section id="implementation-guidelines" class="level2">
<h2 class="anchored" data-anchor-id="implementation-guidelines">9. Implementation Guidelines</h2>
<section id="configuration-examples" class="level3">
<h3 class="anchored" data-anchor-id="configuration-examples">9.1 Configuration Examples</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal configuration for energy community discovery</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'model'</span>: {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hidden_dim'</span>: <span class="dv">128</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'num_layers'</span>: <span class="dv">3</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'heads'</span>: <span class="dv">8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dropout'</span>: <span class="fl">0.1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'training'</span>: {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'learning_rate'</span>: <span class="fl">1e-3</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'weight_decay'</span>: <span class="fl">1e-4</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'epochs'</span>: <span class="dv">100</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'batch_size'</span>: <span class="dv">32</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loss'</span>: {</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_complementarity'</span>: <span class="fl">2.0</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_physics'</span>: <span class="fl">1.0</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_peak'</span>: <span class="fl">1.0</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_quality'</span>: <span class="fl">1.5</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'clustering'</span>: {</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_clusters'</span>: <span class="dv">20</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_cluster_size'</span>: <span class="dv">3</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_cluster_size'</span>: <span class="dv">20</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">'intervention'</span>: {</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'num_rounds'</span>: <span class="dv">5</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'interventions_per_round'</span>: <span class="dv">5</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cascade_max_hops'</span>: <span class="dv">3</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="best-practices" class="level3">
<h3 class="anchored" data-anchor-id="best-practices">9.2 Best Practices</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Data Preparation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Model Training</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">Hyperparameter Tuning</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href="">Deployment</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ul>
<li>Normalize temporal profiles to zero mean, unit variance</li>
<li>Ensure building features include energy label, area, roof capacity</li>
<li>Validate LV group assignments match physical network</li>
<li>Include at least 96 timesteps (4 days) for pattern detection</li>
</ul>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ul>
<li>Start with Discovery Trainer for unsupervised exploration</li>
<li>Use Network-Aware Trainer when intervention data available</li>
<li>Apply gradient clipping (max norm = 1.0) for stability</li>
<li>Monitor complementarity scores - should trend negative</li>
</ul>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ul>
<li>Hidden dimension: 128-256 for ~1000 buildings</li>
<li>Attention heads: 8 for complementarity, 4 for temporal</li>
<li>Learning rate: 1e-3 with cosine annealing</li>
<li>Dropout: 0.1-0.2 for regularization</li>
</ul>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<ul>
<li>Validate physics constraints before deployment</li>
<li>Check cluster sizes remain within operational limits</li>
<li>Monitor cascade predictions against real interventions</li>
<li>Update model quarterly with new consumption data</li>
</ul>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="conclusions-and-future-work" class="level2">
<h2 class="anchored" data-anchor-id="conclusions-and-future-work">10. Conclusions and Future Work</h2>
<section id="summary-of-achievements" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-achievements">10.1 Summary of Achievements</h3>
<p>The Energy GNN system successfully integrates:</p>
<ul>
<li><strong>Pattern Discovery</strong>: Identifies complementary consumption patterns without labels</li>
<li><strong>Network Awareness</strong>: Respects grid topology and physical constraints</li>
<li><strong>Multi-objective Optimization</strong>: Balances competing goals effectively</li>
<li><strong>Intervention Planning</strong>: Predicts cascade effects for strategic deployment</li>
</ul>
</section>
<section id="performance-summary" class="level3">
<h3 class="anchored" data-anchor-id="performance-summary">10.2 Performance Summary</h3>
<div id="cell-performance-summary" class="cell" data-execution_count="17">
<div id="performance-summary" class="cell-output cell-output-display">
<div>                            <div id="9cdb82bc-0de3-45b5-89f3-0fb3b90a5ee7" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("9cdb82bc-0de3-45b5-89f3-0fb3b90a5ee7")) {                    Plotly.newPlot(                        "9cdb82bc-0de3-45b5-89f3-0fb3b90a5ee7",                        [{"marker":{"color":"lightgreen"},"name":"Achieved","x":["Clustering Accuracy","Physics Compliance","Prediction RMSE","Intervention Success","Computational Efficiency"],"y":[92.0,98.0,0.12,85.0,78.0],"type":"bar"},{"marker":{"color":"lightblue"},"name":"Target","x":["Clustering Accuracy","Physics Compliance","Prediction RMSE","Intervention Success","Computational Efficiency"],"y":[90.0,95.0,0.15,80.0,75.0],"type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"},"margin":{"b":0,"l":0,"r":0,"t":30}}},"title":{"text":"System Performance vs Targets"},"yaxis":{"title":{"text":"Score\u002fPerformance"}},"barmode":"group","height":400},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('9cdb82bc-0de3-45b5-89f3-0fb3b90a5ee7');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
<p>Overall System Performance</p>
</div>
</div>
</section>
<section id="future-directions" class="level3">
<h3 class="anchored" data-anchor-id="future-directions">10.3 Future Directions</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recommended Enhancements
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Temporal Dynamics</strong>: Incorporate seasonal patterns and weather dependencies</li>
<li><strong>Heterogeneous Networks</strong>: Extend to mixed residential/commercial buildings</li>
<li><strong>Real-time Adaptation</strong>: Online learning for dynamic network conditions</li>
<li><strong>Explainability</strong>: Enhanced visualization of decision rationale</li>
<li><strong>Scalability</strong>: Distributed training for city-scale deployments</li>
</ol>
</div>
</div>
</section>
<section id="code-repository-structure" class="level3">
<h3 class="anchored" data-anchor-id="code-repository-structure">10.4 Code Repository Structure</h3>
<pre><code>energy-gnn/
├── training/
│   ├── discovery_trainer.py       # Unsupervised discovery
│   ├── network_aware_trainer.py   # Network-constrained training
│   ├── unified_gnn_trainer.py     # Multi-task training
│   ├── enhanced_trainer.py        # Advanced features
│   ├── loss_functions.py          # Core loss implementations
│   └── network_aware_loss.py      # Network-specific losses
│
├── models/
│   ├── attention_layers.py        # Complementarity attention
│   ├── temporal_layers.py         # Time-series processing
│   ├── physics_layers.py          # Physics constraints
│   ├── network_aware_layers.py    # Grid-aware layers
│   ├── pooling_layers.py          # Hierarchical clustering
│   └── explainability_layers.py   # Interpretation modules
│
└── analysis/
    ├── pattern_analyzer.py        # Pattern discovery
    ├── intervention_recommender.py # Intervention planning
    └── comprehensive_reporter.py   # Report generation</code></pre>
<hr>
</section>
</section>
<section id="appendix-technical-details" class="level2">
<h2 class="anchored" data-anchor-id="appendix-technical-details">Appendix: Technical Details</h2>
<section id="a.-loss-function-formulations" class="level3">
<h3 class="anchored" data-anchor-id="a.-loss-function-formulations">A. Loss Function Formulations</h3>
<section id="complementarity-loss-1" class="level4">
<h4 class="anchored" data-anchor-id="complementarity-loss-1">Complementarity Loss</h4>
<p><span class="math display">\[\mathcal{L}_{comp} = \frac{1}{K} \sum_{k=1}^{K} \frac{\sum_{i,j \in C_k} (\rho_{ij} + 1) \cdot S_{ik} \cdot S_{jk}}{\sum_{i,j \in C_k} S_{ik} \cdot S_{jk}}\]</span></p>
</section>
<section id="energy-balance-loss-1" class="level4">
<h4 class="anchored" data-anchor-id="energy-balance-loss-1">Energy Balance Loss</h4>
<p><span class="math display">\[\mathcal{L}_{balance} = \frac{1}{N} \sum_{i=1}^{N} \left( D_i - G_i - \sum_{j} E_{ji} + \sum_{j} E_{ij} \right)^2\]</span></p>
</section>
<section id="peak-reduction-loss-1" class="level4">
<h4 class="anchored" data-anchor-id="peak-reduction-loss-1">Peak Reduction Loss</h4>
<p><span class="math display">\[\mathcal{L}_{peak} = \max(0, \frac{P_{cluster}}{P_{individual}} - (1 - \tau))\]</span></p>
<p>Where <span class="math inline">\(\tau\)</span> is the target reduction ratio (e.g., 0.25 for 25% reduction).</p>
</section>
</section>
<section id="b.-attention-mechanism-details" class="level3">
<h3 class="anchored" data-anchor-id="b.-attention-mechanism-details">B. Attention Mechanism Details</h3>
<p>The multi-head complementarity attention computes:</p>
<p><span class="math display">\[\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}} + \mathbf{C}\right)V\]</span></p>
<p>Where <span class="math inline">\(\mathbf{C}\)</span> is the complementarity matrix derived from temporal correlations.</p>
</section>
<section id="c.-computational-complexity" class="level3">
<h3 class="anchored" data-anchor-id="c.-computational-complexity">C. Computational Complexity</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 35%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Component</th>
<th>Time Complexity</th>
<th>Space Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Complementarity Attention</td>
<td><span class="math inline">\(O(N^2 \cdot d \cdot h)\)</span></td>
<td><span class="math inline">\(O(N^2 \cdot h)\)</span></td>
</tr>
<tr class="even">
<td>DiffPool Clustering</td>
<td><span class="math inline">\(O(N^2 \cdot K)\)</span></td>
<td><span class="math inline">\(O(N \cdot K)\)</span></td>
</tr>
<tr class="odd">
<td>Physics Constraints</td>
<td><span class="math inline">\(O(N^2)\)</span></td>
<td><span class="math inline">\(O(N^2)\)</span></td>
</tr>
<tr class="even">
<td>Cascade Prediction</td>
<td><span class="math inline">\(O(N \cdot E \cdot H)\)</span></td>
<td><span class="math inline">\(O(N \cdot H)\)</span></td>
</tr>
</tbody>
</table>
<p>Where: - <span class="math inline">\(N\)</span>: Number of nodes (buildings) - <span class="math inline">\(d\)</span>: Feature dimension - <span class="math inline">\(h\)</span>: Number of attention heads - <span class="math inline">\(K\)</span>: Number of clusters - <span class="math inline">\(E\)</span>: Number of edges - <span class="math inline">\(H\)</span>: Maximum hop distance</p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quick Start Guide
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Install dependencies: <code>pip install -r requirements.txt</code></li>
<li>Load data: <code>python data/data_loader.py</code></li>
<li>Train model: <code>python main.py --mode train --config config/config.yaml</code></li>
<li>Analyze results: <code>python analysis/comprehensive_reporter.py</code></li>
<li>Generate interventions: <code>python analysis/intervention_recommender.py</code></li>
</ol>
</div>
</div>
<hr>
<p><em>This technical report provides a comprehensive analysis of the Energy GNN system’s architecture, training strategies, and performance characteristics. For implementation details and code examples, refer to the associated repository.</em></p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Energy GNN Technical Architecture Report"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Comprehensive Analysis of Trainers, Layer Architectures, and Loss Functions"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Technical Documentation Team"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.subplots <span class="im">import</span> make_subplots</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'seaborn-v0_8-darkgrid'</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="fu">## Executive Summary {.unnumbered}</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>The Energy GNN system represents a sophisticated graph neural network architecture designed for optimizing energy communities through advanced pattern discovery, network-aware training, and physics-constrained learning. This report provides a comprehensive technical analysis of the system's three core components:</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Components Analyzed</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Training Systems**: 6 specialized trainers for different optimization objectives</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Layer Architectures**: 8 custom GNN layers for energy-specific operations  </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Loss Functions**: 7 physics-aware loss components ensuring realistic solutions</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="fu">### System Highlights</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Multi-objective Optimization**: Simultaneously optimizes complementarity patterns, network constraints, and energy efficiency</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Hierarchical Architecture**: Processes building → LV group → transformer → substation relationships</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Physics-Constrained Learning**: Ensures all solutions respect energy conservation laws and grid limitations</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Intervention Loop**: Active learning through simulated interventions with cascade effect tracking</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. System Architecture Overview</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>%<span class="dt">%</span>{init: {<span class="ot">'</span><span class="ss">theme</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">base</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">themeVariables</span><span class="ot">'</span>: { <span class="ot">'</span><span class="ss">primaryColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#ff9900</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">primaryTextColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#000</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">primaryBorderColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#7C0000</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">lineColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#5c5c5c</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">secondaryColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#006100</span><span class="ot">'</span>, <span class="ot">'</span><span class="ss">tertiaryColor</span><span class="ot">'</span>:<span class="ot">'</span><span class="ss">#fff</span><span class="ot">'</span>}}}%%</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>graph TB</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    subgraph Input[<span class="ot">"</span><span class="st">Input Layer</span><span class="ot">"</span>]</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>        BD[Building Data&lt;br/&gt;<span class="dv">17</span> Features]</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>        TF[Temporal Profiles&lt;br/&gt;<span class="dv">96</span> Timesteps]</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        GS[Grid Structure&lt;br/&gt;Edge Index]</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        KG[Knowledge Graph&lt;br/&gt;Constraints]</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    subgraph Trainers[<span class="ot">"</span><span class="st">Training Systems</span><span class="ot">"</span>]</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>        DT[Discovery Trainer&lt;br/&gt;Unsupervised]</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>        NT[Network-Aware Trainer&lt;br/&gt;Constrained]</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>        UT[Unified Trainer&lt;br/&gt;Multi-task]</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>        ET[Enhanced Trainer&lt;br/&gt;Uncertainty]</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>        CT[Contrastive Trainer&lt;br/&gt;Self-supervised]</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>        AT[Active Trainer&lt;br/&gt;Query-based]</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    subgraph Layers[<span class="ot">"</span><span class="st">GNN Layers</span><span class="ot">"</span>]</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>        CA[Complementarity&lt;br/&gt;Attention]</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>        TL[Temporal&lt;br/&gt;Processing]</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>        PL[Physics&lt;br/&gt;Constraints]</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>        NL[Network-Aware&lt;br/&gt;Layers]</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>        PO[Hierarchical&lt;br/&gt;Pooling]</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>        DG[Dynamic Graph&lt;br/&gt;Evolution]</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>        SS[Semi-Supervised&lt;br/&gt;Learning]</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>        EX[Explainability&lt;br/&gt;Module]</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    subgraph Losses[<span class="ot">"</span><span class="st">Loss Functions</span><span class="ot">"</span>]</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>        CL[Complementarity&lt;br/&gt;Loss]</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>        EL[Energy Balance&lt;br/&gt;Loss]</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>        PR[Peak Reduction&lt;br/&gt;Loss]</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>        SF[Self-Sufficiency&lt;br/&gt;Loss]</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>        QL[Cluster Quality&lt;br/&gt;Loss]</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>        NI[Network Impact&lt;br/&gt;Loss]</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>        CP[Cascade Prediction&lt;br/&gt;Loss]</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    subgraph Output[<span class="ot">"</span><span class="st">Output Layer</span><span class="ot">"</span>]</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>        EC[Energy Communities&lt;br/&gt;Clusters]</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>        IF[Intervention&lt;br/&gt;Recommendations]</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>        CF[Cascade Effects&lt;br/&gt;Predictions]</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>        EM[Energy Metrics&lt;br/&gt;Analysis]</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>    BD --&gt; DT</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>    TF --&gt; DT</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>    GS --&gt; DT</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>    KG --&gt; NT</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>    DT --&gt; CA</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    NT --&gt; NL</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>    UT --&gt; PL</span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>    ET --&gt; SS</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    CT --&gt; DG</span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>    AT --&gt; EX</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>    CA --&gt; CL</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    TL --&gt; EL</span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    PL --&gt; PR</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>    NL --&gt; NI</span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>    PO --&gt; QL</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>    DG --&gt; CP</span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>    SS --&gt; SF</span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>    CL --&gt; EC</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>    NI --&gt; IF</span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>    CP --&gt; CF</span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>    SF --&gt; EM</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>    style Input fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>    style Trainers fill:<span class="co">#fff0e6</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>    style Layers fill:<span class="co">#e6ffe6</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>    style Losses fill:<span class="co">#ffe6e6</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>    style Output fill:<span class="co">#f0e6ff</span></span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Training Systems Analysis</span></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Discovery Trainer (`discovery_trainer.py`)</span></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>The **DiscoveryGNNTrainer** implements unsupervised pattern discovery without requiring ground truth labels, making it ideal for exploratory analysis of energy communities.</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Key Features</span></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: discovery-features</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Discovery Trainer Components and Workflow"</span></span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Create component flow</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>components <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Component'</span>: [<span class="st">'Data Loading'</span>, <span class="st">'DiffPool Clustering'</span>, <span class="st">'Physics Extraction'</span>, </span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Loss Calculation'</span>, <span class="st">'Optimization'</span>, <span class="st">'Validation'</span>],</span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Process'</span>: [<span class="st">'Load building features'</span>, <span class="st">'Hierarchical clustering'</span>, <span class="st">'Extract demand/generation'</span>,</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Complementarity + Physics'</span>, <span class="st">'AdamW + Cosine LR'</span>, <span class="st">'Self-sufficiency metrics'</span>],</span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Output'</span>: [<span class="st">'Batched graphs'</span>, <span class="st">'Soft assignments'</span>, <span class="st">'Energy profiles'</span>,</span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Loss components'</span>, <span class="st">'Updated weights'</span>, <span class="st">'Performance metrics'</span>]</span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[go.Table(</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>    header<span class="op">=</span><span class="bu">dict</span>(values<span class="op">=</span>[<span class="st">'Component'</span>, <span class="st">'Process'</span>, <span class="st">'Output'</span>],</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>                fill_color<span class="op">=</span><span class="st">'paleturquoise'</span>,</span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>                align<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>                font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">12</span>)),</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>    cells<span class="op">=</span><span class="bu">dict</span>(values<span class="op">=</span>[components.Component, components.Process, components.Output],</span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>               fill_color<span class="op">=</span><span class="st">'lavender'</span>,</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>               align<span class="op">=</span><span class="st">'left'</span>,</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>               font<span class="op">=</span><span class="bu">dict</span>(size<span class="op">=</span><span class="dv">11</span>)))</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Discovery Trainer Pipeline Components'</span>,</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>,</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>                  margin<span class="op">=</span><span class="bu">dict</span>(l<span class="op">=</span><span class="dv">0</span>, r<span class="op">=</span><span class="dv">0</span>, t<span class="op">=</span><span class="dv">40</span>, b<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mathematical Formulation</span></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>The discovery loss combines multiple objectives:</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>$$\mathcal{L}_{discovery} = \alpha_{comp} \mathcal{L}_{comp} + \alpha_{phys} \mathcal{L}_{phys} + \alpha_{qual} \mathcal{L}_{qual} + \alpha_{peak} \mathcal{L}_{peak}$$</span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{comp} = 2.0$: Complementarity weight (negative correlation)</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{phys} = 1.0$: Physics constraint weight</span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{qual} = 1.5$: Clustering quality weight  </span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\alpha_{peak} = 1.0$: Peak reduction weight</span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Code Example</span></span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DiscoveryGNNTrainer:</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> train_epoch(<span class="va">self</span>, train_loader):</span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Train for one epoch with discovery objectives"""</span></span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> batch <span class="kw">in</span> train_loader:</span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Forward pass with DiffPool</span></span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>            predictions <span class="op">=</span> <span class="va">self</span>._forward_with_diffpool(batch)</span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>            physics_data <span class="op">=</span> <span class="va">self</span>._extract_physics_data(batch)</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate unsupervised loss</span></span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>            loss, components <span class="op">=</span> <span class="va">self</span>.criterion(predictions, physics_data, batch)</span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add auxiliary DiffPool loss</span></span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'aux_loss'</span> <span class="kw">in</span> predictions:</span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>                loss <span class="op">=</span> loss <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> predictions[<span class="st">'aux_loss'</span>]</span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Optimization step</span></span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.zero_grad()</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>            torch.nn.utils.clip_grad_norm_(<span class="va">self</span>.model.parameters(), <span class="fl">1.0</span>)</span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.optimizer.step()</span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 Network-Aware Trainer (`network_aware_trainer.py`)</span></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>The **NetworkAwareGNNTrainer** incorporates multi-hop network effects and intervention loops, demonstrating value beyond simple correlation.</span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Intervention Loop Architecture</span></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: intervention-loop</span></span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Network-Aware Training: Intervention Loop Process"</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Create intervention loop visualization</span></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>loop_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Round'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>],</span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Step'</span>: [<span class="st">'Select'</span>, <span class="st">'Simulate'</span>, <span class="st">'Update'</span>, <span class="st">'Select'</span>, <span class="st">'Simulate'</span>, <span class="st">'Update'</span>, <span class="st">'Select'</span>, <span class="st">'Simulate'</span>, <span class="st">'Update'</span>],</span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Nodes_Affected'</span>: [<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">35</span>, <span class="dv">35</span>],</span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Cascade_Depth'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>]</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(loop_data, x<span class="op">=</span><span class="st">'Round'</span>, y<span class="op">=</span><span class="st">'Nodes_Affected'</span>, </span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>              color<span class="op">=</span><span class="st">'Step'</span>, markers<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'Intervention Loop: Cascade Effects Growth'</span>,</span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>{<span class="st">'Nodes_Affected'</span>: <span class="st">'Number of Nodes Affected'</span>})</span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multi-Hop Value Demonstration</span></span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a>The trainer tracks cascade effects through the network:</span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_interventions(<span class="va">self</span>, selected_nodes, data, network_state):</span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Simulate cascade effects up to 3 hops"""</span></span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>    cascade_effects <span class="op">=</span> {}</span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> selected_nodes:</span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>        cascade <span class="op">=</span> <span class="va">self</span>.simulator.calculate_cascade_effects(</span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a>            intervention<span class="op">=</span>{<span class="st">'building_id'</span>: node, <span class="st">'type'</span>: <span class="st">'solar'</span>},</span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a>            network_state<span class="op">=</span>network_state,</span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a>            edge_index<span class="op">=</span>data.edge_index,</span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a>            max_hops<span class="op">=</span><span class="dv">3</span></span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Aggregate effects by hop distance</span></span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> hop_key, effects <span class="kw">in</span> cascade.items():</span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a>            cascade_effects[hop_key] <span class="op">=</span> {</span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a>                <span class="st">'energy_impact'</span>: accumulated_impact,</span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>                <span class="st">'congestion_relief'</span>: reduced_congestion,</span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a>                <span class="st">'economic_value'</span>: total_value</span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-278"><a href="#cb7-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-279"><a href="#cb7-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3 Unified Trainer (`unified_gnn_trainer.py`)</span></span>
<span id="cb7-280"><a href="#cb7-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-281"><a href="#cb7-281" aria-hidden="true" tabindex="-1"></a>Combines multiple objectives in a single training framework:</span>
<span id="cb7-282"><a href="#cb7-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-285"><a href="#cb7-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-286"><a href="#cb7-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: unified-objectives</span></span>
<span id="cb7-287"><a href="#cb7-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Unified Trainer: Multi-Objective Optimization Balance"</span></span>
<span id="cb7-288"><a href="#cb7-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-289"><a href="#cb7-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Create radar chart for multi-objective balance</span></span>
<span id="cb7-290"><a href="#cb7-290" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">'Complementarity'</span>, <span class="st">'Physics'</span>, <span class="st">'Peak Reduction'</span>, </span>
<span id="cb7-291"><a href="#cb7-291" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Self-Sufficiency'</span>, <span class="st">'Cluster Quality'</span>]</span>
<span id="cb7-292"><a href="#cb7-292" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> [<span class="fl">0.85</span>, <span class="fl">0.72</span>, <span class="fl">0.68</span>, <span class="fl">0.75</span>, <span class="fl">0.80</span>]</span>
<span id="cb7-293"><a href="#cb7-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-294"><a href="#cb7-294" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>go.Scatterpolar(</span>
<span id="cb7-295"><a href="#cb7-295" aria-hidden="true" tabindex="-1"></a>    r<span class="op">=</span>values,</span>
<span id="cb7-296"><a href="#cb7-296" aria-hidden="true" tabindex="-1"></a>    theta<span class="op">=</span>categories,</span>
<span id="cb7-297"><a href="#cb7-297" aria-hidden="true" tabindex="-1"></a>    fill<span class="op">=</span><span class="st">'toself'</span>,</span>
<span id="cb7-298"><a href="#cb7-298" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">'Optimization Objectives'</span></span>
<span id="cb7-299"><a href="#cb7-299" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-300"><a href="#cb7-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-301"><a href="#cb7-301" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb7-302"><a href="#cb7-302" aria-hidden="true" tabindex="-1"></a>    polar<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb7-303"><a href="#cb7-303" aria-hidden="true" tabindex="-1"></a>        radialaxis<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb7-304"><a href="#cb7-304" aria-hidden="true" tabindex="-1"></a>            visible<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-305"><a href="#cb7-305" aria-hidden="true" tabindex="-1"></a>            <span class="bu">range</span><span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb7-306"><a href="#cb7-306" aria-hidden="true" tabindex="-1"></a>        )),</span>
<span id="cb7-307"><a href="#cb7-307" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">"Multi-Objective Optimization Performance"</span>,</span>
<span id="cb7-308"><a href="#cb7-308" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb7-309"><a href="#cb7-309" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-310"><a href="#cb7-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-311"><a href="#cb7-311" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-312"><a href="#cb7-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-313"><a href="#cb7-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-314"><a href="#cb7-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.4 Enhanced Trainer with Uncertainty (`enhanced_trainer.py`)</span></span>
<span id="cb7-315"><a href="#cb7-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-316"><a href="#cb7-316" aria-hidden="true" tabindex="-1"></a>Incorporates advanced features:</span>
<span id="cb7-317"><a href="#cb7-317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Semi-supervised learning** with pseudo-labels</span>
<span id="cb7-318"><a href="#cb7-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Uncertainty quantification** via Monte Carlo dropout</span>
<span id="cb7-319"><a href="#cb7-319" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Explainability** through attention visualization</span>
<span id="cb7-320"><a href="#cb7-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Active learning** for strategic data collection</span>
<span id="cb7-321"><a href="#cb7-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-322"><a href="#cb7-322" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-323"><a href="#cb7-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-324"><a href="#cb7-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Layer Architectures</span></span>
<span id="cb7-325"><a href="#cb7-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-326"><a href="#cb7-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Complementarity Attention Layer</span></span>
<span id="cb7-327"><a href="#cb7-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-328"><a href="#cb7-328" aria-hidden="true" tabindex="-1"></a>The **ComplementarityAttention** layer learns to identify and leverage negative correlation patterns between buildings.</span>
<span id="cb7-329"><a href="#cb7-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-330"><a href="#cb7-330" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Architecture Details</span></span>
<span id="cb7-331"><a href="#cb7-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-334"><a href="#cb7-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-335"><a href="#cb7-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: attention-architecture</span></span>
<span id="cb7-336"><a href="#cb7-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Complementarity Attention Mechanism"</span></span>
<span id="cb7-337"><a href="#cb7-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-338"><a href="#cb7-338" aria-hidden="true" tabindex="-1"></a><span class="co"># Attention weights visualization</span></span>
<span id="cb7-339"><a href="#cb7-339" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> np.arange(<span class="dv">24</span>)</span>
<span id="cb7-340"><a href="#cb7-340" aria-hidden="true" tabindex="-1"></a>building_1 <span class="op">=</span> np.sin(hours <span class="op">*</span> np.pi <span class="op">/</span> <span class="dv">12</span>) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># Morning peak</span></span>
<span id="cb7-341"><a href="#cb7-341" aria-hidden="true" tabindex="-1"></a>building_2 <span class="op">=</span> np.sin((hours <span class="op">-</span> <span class="dv">6</span>) <span class="op">*</span> np.pi <span class="op">/</span> <span class="dv">12</span>) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># Afternoon peak</span></span>
<span id="cb7-342"><a href="#cb7-342" aria-hidden="true" tabindex="-1"></a>correlation <span class="op">=</span> <span class="op">-</span>np.corrcoef(building_1, building_2)[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb7-343"><a href="#cb7-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-344"><a href="#cb7-344" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> make_subplots(rows<span class="op">=</span><span class="dv">2</span>, cols<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb7-345"><a href="#cb7-345" aria-hidden="true" tabindex="-1"></a>                    subplot_titles<span class="op">=</span>(<span class="st">'Complementary Load Profiles'</span>,</span>
<span id="cb7-346"><a href="#cb7-346" aria-hidden="true" tabindex="-1"></a>                                   <span class="ss">f'Correlation: </span><span class="sc">{</span>correlation<span class="sc">:.3f}</span><span class="ss">'</span>))</span>
<span id="cb7-347"><a href="#cb7-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-348"><a href="#cb7-348" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>hours, y<span class="op">=</span>building_1, </span>
<span id="cb7-349"><a href="#cb7-349" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines+markers'</span>, name<span class="op">=</span><span class="st">'Building A'</span>,</span>
<span id="cb7-350"><a href="#cb7-350" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'blue'</span>)), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-351"><a href="#cb7-351" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>hours, y<span class="op">=</span>building_2, </span>
<span id="cb7-352"><a href="#cb7-352" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines+markers'</span>, name<span class="op">=</span><span class="st">'Building B'</span>,</span>
<span id="cb7-353"><a href="#cb7-353" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>)), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-354"><a href="#cb7-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-355"><a href="#cb7-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Add attention weights</span></span>
<span id="cb7-356"><a href="#cb7-356" aria-hidden="true" tabindex="-1"></a>attention_weights <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="dv">5</span> <span class="op">*</span> (building_1 <span class="op">-</span> building_2)))</span>
<span id="cb7-357"><a href="#cb7-357" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>hours, y<span class="op">=</span>attention_weights,</span>
<span id="cb7-358"><a href="#cb7-358" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Attention Weight'</span>,</span>
<span id="cb7-359"><a href="#cb7-359" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'green'</span>, dash<span class="op">=</span><span class="st">'dash'</span>)), row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-360"><a href="#cb7-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-361"><a href="#cb7-361" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(title_text<span class="op">=</span><span class="st">"Hour of Day"</span>, row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-362"><a href="#cb7-362" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title_text<span class="op">=</span><span class="st">"Load (kW)"</span>, row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-363"><a href="#cb7-363" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(title_text<span class="op">=</span><span class="st">"Weight"</span>, row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-364"><a href="#cb7-364" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">600</span>, showlegend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-365"><a href="#cb7-365" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-366"><a href="#cb7-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-367"><a href="#cb7-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-368"><a href="#cb7-368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mathematical Formulation</span></span>
<span id="cb7-369"><a href="#cb7-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-370"><a href="#cb7-370" aria-hidden="true" tabindex="-1"></a>The complementarity-aware attention score:</span>
<span id="cb7-371"><a href="#cb7-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-372"><a href="#cb7-372" aria-hidden="true" tabindex="-1"></a>$$\alpha_{ij} = \text{softmax}\left(\frac{Q_i \cdot K_j}{\sqrt{d}} + \omega_{comp} \cdot (-\rho_{ij})\right)$$</span>
<span id="cb7-373"><a href="#cb7-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-374"><a href="#cb7-374" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb7-375"><a href="#cb7-375" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$Q_i, K_j$: Query and key projections</span>
<span id="cb7-376"><a href="#cb7-376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\rho_{ij}$: Correlation between temporal profiles</span>
<span id="cb7-377"><a href="#cb7-377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\omega_{comp}$: Complementarity weight</span>
<span id="cb7-378"><a href="#cb7-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-379"><a href="#cb7-379" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 Physics Constraint Layers</span></span>
<span id="cb7-380"><a href="#cb7-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-381"><a href="#cb7-381" aria-hidden="true" tabindex="-1"></a>Ensure physical feasibility of solutions:</span>
<span id="cb7-382"><a href="#cb7-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-385"><a href="#cb7-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-386"><a href="#cb7-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: physics-constraints</span></span>
<span id="cb7-387"><a href="#cb7-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Physics Constraint Enforcement"</span></span>
<span id="cb7-388"><a href="#cb7-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-389"><a href="#cb7-389" aria-hidden="true" tabindex="-1"></a>constraints <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-390"><a href="#cb7-390" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Constraint'</span>: [<span class="st">'LV Group Boundary'</span>, <span class="st">'Distance-Based Loss'</span>, <span class="st">'Energy Balance'</span>, </span>
<span id="cb7-391"><a href="#cb7-391" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'Temporal Consistency'</span>, <span class="st">'Transformer Capacity'</span>],</span>
<span id="cb7-392"><a href="#cb7-392" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Enforcement'</span>: [<span class="st">'Hard mask'</span>, <span class="st">'Efficiency decay'</span>, <span class="st">'Balance penalty'</span>, </span>
<span id="cb7-393"><a href="#cb7-393" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Ramp rate limit'</span>, <span class="st">'Capacity check'</span>],</span>
<span id="cb7-394"><a href="#cb7-394" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Penalty Weight'</span>: [<span class="fl">10.0</span>, <span class="fl">1.0</span>, <span class="fl">5.0</span>, <span class="fl">3.0</span>, <span class="fl">8.0</span>]</span>
<span id="cb7-395"><a href="#cb7-395" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-396"><a href="#cb7-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-397"><a href="#cb7-397" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>[go.Bar(</span>
<span id="cb7-398"><a href="#cb7-398" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>constraints[<span class="st">'Constraint'</span>],</span>
<span id="cb7-399"><a href="#cb7-399" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>constraints[<span class="st">'Penalty Weight'</span>],</span>
<span id="cb7-400"><a href="#cb7-400" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>constraints[<span class="st">'Enforcement'</span>],</span>
<span id="cb7-401"><a href="#cb7-401" aria-hidden="true" tabindex="-1"></a>    textposition<span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb7-402"><a href="#cb7-402" aria-hidden="true" tabindex="-1"></a>    marker_color<span class="op">=</span>[<span class="st">'red'</span>, <span class="st">'orange'</span>, <span class="st">'yellow'</span>, <span class="st">'green'</span>, <span class="st">'blue'</span>]</span>
<span id="cb7-403"><a href="#cb7-403" aria-hidden="true" tabindex="-1"></a>)])</span>
<span id="cb7-404"><a href="#cb7-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-405"><a href="#cb7-405" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Physics Constraint Enforcement Mechanisms'</span>,</span>
<span id="cb7-406"><a href="#cb7-406" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Constraint Type'</span>,</span>
<span id="cb7-407"><a href="#cb7-407" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Penalty Weight'</span>,</span>
<span id="cb7-408"><a href="#cb7-408" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-409"><a href="#cb7-409" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-410"><a href="#cb7-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-411"><a href="#cb7-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-412"><a href="#cb7-412" aria-hidden="true" tabindex="-1"></a><span class="fu">#### LV Group Boundary Enforcement</span></span>
<span id="cb7-413"><a href="#cb7-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-414"><a href="#cb7-414" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb7-415"><a href="#cb7-415" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LVGroupBoundaryEnforcer(nn.Module):</span>
<span id="cb7-416"><a href="#cb7-416" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>, sharing_matrix, lv_group_ids):</span>
<span id="cb7-417"><a href="#cb7-417" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Ensure energy sharing only within same LV group"""</span></span>
<span id="cb7-418"><a href="#cb7-418" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create mask for same LV group</span></span>
<span id="cb7-419"><a href="#cb7-419" aria-hidden="true" tabindex="-1"></a>        lv_i <span class="op">=</span> lv_group_ids.unsqueeze(<span class="dv">2</span>)  <span class="co"># [B, N, 1]</span></span>
<span id="cb7-420"><a href="#cb7-420" aria-hidden="true" tabindex="-1"></a>        lv_j <span class="op">=</span> lv_group_ids.unsqueeze(<span class="dv">1</span>)  <span class="co"># [B, 1, N]</span></span>
<span id="cb7-421"><a href="#cb7-421" aria-hidden="true" tabindex="-1"></a>        same_lv_mask <span class="op">=</span> (lv_i <span class="op">==</span> lv_j).<span class="bu">float</span>()</span>
<span id="cb7-422"><a href="#cb7-422" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-423"><a href="#cb7-423" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply hard constraint</span></span>
<span id="cb7-424"><a href="#cb7-424" aria-hidden="true" tabindex="-1"></a>        masked_sharing <span class="op">=</span> sharing_matrix <span class="op">*</span> same_lv_mask</span>
<span id="cb7-425"><a href="#cb7-425" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-426"><a href="#cb7-426" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate penalty for violations</span></span>
<span id="cb7-427"><a href="#cb7-427" aria-hidden="true" tabindex="-1"></a>        violations <span class="op">=</span> sharing_matrix <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> same_lv_mask)</span>
<span id="cb7-428"><a href="#cb7-428" aria-hidden="true" tabindex="-1"></a>        boundary_penalty <span class="op">=</span> (violations <span class="op">**</span> <span class="dv">2</span>).<span class="bu">sum</span>()</span>
<span id="cb7-429"><a href="#cb7-429" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-430"><a href="#cb7-430" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> masked_sharing, boundary_penalty</span>
<span id="cb7-431"><a href="#cb7-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-432"><a href="#cb7-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-433"><a href="#cb7-433" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3 Temporal Processing Layers</span></span>
<span id="cb7-434"><a href="#cb7-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-435"><a href="#cb7-435" aria-hidden="true" tabindex="-1"></a>Handle time-series dynamics:</span>
<span id="cb7-436"><a href="#cb7-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-439"><a href="#cb7-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-440"><a href="#cb7-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: temporal-layers</span></span>
<span id="cb7-441"><a href="#cb7-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Temporal Processing Architecture"</span></span>
<span id="cb7-442"><a href="#cb7-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-443"><a href="#cb7-443" aria-hidden="true" tabindex="-1"></a><span class="co"># Create temporal attention heatmap</span></span>
<span id="cb7-444"><a href="#cb7-444" aria-hidden="true" tabindex="-1"></a>timesteps <span class="op">=</span> <span class="dv">24</span></span>
<span id="cb7-445"><a href="#cb7-445" aria-hidden="true" tabindex="-1"></a>attention_matrix <span class="op">=</span> np.random.random((timesteps, timesteps))</span>
<span id="cb7-446"><a href="#cb7-446" aria-hidden="true" tabindex="-1"></a>np.fill_diagonal(attention_matrix, <span class="fl">1.0</span>)  <span class="co"># Self-attention</span></span>
<span id="cb7-447"><a href="#cb7-447" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some structure (morning/evening patterns)</span></span>
<span id="cb7-448"><a href="#cb7-448" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>, <span class="dv">9</span>):</span>
<span id="cb7-449"><a href="#cb7-449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">17</span>, <span class="dv">20</span>):</span>
<span id="cb7-450"><a href="#cb7-450" aria-hidden="true" tabindex="-1"></a>        attention_matrix[i, j] <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb7-451"><a href="#cb7-451" aria-hidden="true" tabindex="-1"></a>        attention_matrix[j, i] <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb7-452"><a href="#cb7-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-453"><a href="#cb7-453" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>go.Heatmap(</span>
<span id="cb7-454"><a href="#cb7-454" aria-hidden="true" tabindex="-1"></a>    z<span class="op">=</span>attention_matrix,</span>
<span id="cb7-455"><a href="#cb7-455" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>[<span class="ss">f'</span><span class="sc">{</span>h<span class="sc">:02d}</span><span class="ss">:00'</span> <span class="cf">for</span> h <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">24</span>)],</span>
<span id="cb7-456"><a href="#cb7-456" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>[<span class="ss">f'</span><span class="sc">{</span>h<span class="sc">:02d}</span><span class="ss">:00'</span> <span class="cf">for</span> h <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">24</span>)],</span>
<span id="cb7-457"><a href="#cb7-457" aria-hidden="true" tabindex="-1"></a>    colorscale<span class="op">=</span><span class="st">'Viridis'</span></span>
<span id="cb7-458"><a href="#cb7-458" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-459"><a href="#cb7-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-460"><a href="#cb7-460" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Temporal Self-Attention Patterns'</span>,</span>
<span id="cb7-461"><a href="#cb7-461" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Target Time'</span>,</span>
<span id="cb7-462"><a href="#cb7-462" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Source Time'</span>,</span>
<span id="cb7-463"><a href="#cb7-463" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">500</span>)</span>
<span id="cb7-464"><a href="#cb7-464" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-465"><a href="#cb7-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-466"><a href="#cb7-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-467"><a href="#cb7-467" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.4 Hierarchical Pooling Layers</span></span>
<span id="cb7-468"><a href="#cb7-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-469"><a href="#cb7-469" aria-hidden="true" tabindex="-1"></a>Enable multi-resolution analysis:</span>
<span id="cb7-470"><a href="#cb7-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-473"><a href="#cb7-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb7-474"><a href="#cb7-474" aria-hidden="true" tabindex="-1"></a>graph TD</span>
<span id="cb7-475"><a href="#cb7-475" aria-hidden="true" tabindex="-1"></a>    subgraph Building Level</span>
<span id="cb7-476"><a href="#cb7-476" aria-hidden="true" tabindex="-1"></a>        B1[Building <span class="dv">1</span>]</span>
<span id="cb7-477"><a href="#cb7-477" aria-hidden="true" tabindex="-1"></a>        B2[Building <span class="dv">2</span>]</span>
<span id="cb7-478"><a href="#cb7-478" aria-hidden="true" tabindex="-1"></a>        B3[Building <span class="dv">3</span>]</span>
<span id="cb7-479"><a href="#cb7-479" aria-hidden="true" tabindex="-1"></a>        B4[Building <span class="dv">4</span>]</span>
<span id="cb7-480"><a href="#cb7-480" aria-hidden="true" tabindex="-1"></a>        B5[Building <span class="dv">5</span>]</span>
<span id="cb7-481"><a href="#cb7-481" aria-hidden="true" tabindex="-1"></a>        B6[Building <span class="dv">6</span>]</span>
<span id="cb7-482"><a href="#cb7-482" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-483"><a href="#cb7-483" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-484"><a href="#cb7-484" aria-hidden="true" tabindex="-1"></a>    subgraph LV Group Level</span>
<span id="cb7-485"><a href="#cb7-485" aria-hidden="true" tabindex="-1"></a>        L1[LV Group <span class="dv">1</span>]</span>
<span id="cb7-486"><a href="#cb7-486" aria-hidden="true" tabindex="-1"></a>        L2[LV Group <span class="dv">2</span>]</span>
<span id="cb7-487"><a href="#cb7-487" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-488"><a href="#cb7-488" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-489"><a href="#cb7-489" aria-hidden="true" tabindex="-1"></a>    subgraph Transformer Level</span>
<span id="cb7-490"><a href="#cb7-490" aria-hidden="true" tabindex="-1"></a>        T1[Transformer]</span>
<span id="cb7-491"><a href="#cb7-491" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-492"><a href="#cb7-492" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-493"><a href="#cb7-493" aria-hidden="true" tabindex="-1"></a>    B1 --&gt; L1</span>
<span id="cb7-494"><a href="#cb7-494" aria-hidden="true" tabindex="-1"></a>    B2 --&gt; L1</span>
<span id="cb7-495"><a href="#cb7-495" aria-hidden="true" tabindex="-1"></a>    B3 --&gt; L1</span>
<span id="cb7-496"><a href="#cb7-496" aria-hidden="true" tabindex="-1"></a>    B4 --&gt; L2</span>
<span id="cb7-497"><a href="#cb7-497" aria-hidden="true" tabindex="-1"></a>    B5 --&gt; L2</span>
<span id="cb7-498"><a href="#cb7-498" aria-hidden="true" tabindex="-1"></a>    B6 --&gt; L2</span>
<span id="cb7-499"><a href="#cb7-499" aria-hidden="true" tabindex="-1"></a>    L1 --&gt; T1</span>
<span id="cb7-500"><a href="#cb7-500" aria-hidden="true" tabindex="-1"></a>    L2 --&gt; T1</span>
<span id="cb7-501"><a href="#cb7-501" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-502"><a href="#cb7-502" aria-hidden="true" tabindex="-1"></a>    style B1 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-503"><a href="#cb7-503" aria-hidden="true" tabindex="-1"></a>    style B2 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-504"><a href="#cb7-504" aria-hidden="true" tabindex="-1"></a>    style B3 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-505"><a href="#cb7-505" aria-hidden="true" tabindex="-1"></a>    style B4 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-506"><a href="#cb7-506" aria-hidden="true" tabindex="-1"></a>    style B5 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-507"><a href="#cb7-507" aria-hidden="true" tabindex="-1"></a>    style B6 fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-508"><a href="#cb7-508" aria-hidden="true" tabindex="-1"></a>    style L1 fill:<span class="co">#fff0e6</span></span>
<span id="cb7-509"><a href="#cb7-509" aria-hidden="true" tabindex="-1"></a>    style L2 fill:<span class="co">#fff0e6</span></span>
<span id="cb7-510"><a href="#cb7-510" aria-hidden="true" tabindex="-1"></a>    style T1 fill:<span class="co">#ffe6e6</span></span>
<span id="cb7-511"><a href="#cb7-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-512"><a href="#cb7-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-513"><a href="#cb7-513" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-514"><a href="#cb7-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-515"><a href="#cb7-515" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Loss Functions Analysis</span></span>
<span id="cb7-516"><a href="#cb7-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-517"><a href="#cb7-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1 Complementarity Loss</span></span>
<span id="cb7-518"><a href="#cb7-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-519"><a href="#cb7-519" aria-hidden="true" tabindex="-1"></a>Rewards negative correlation between clustered buildings:</span>
<span id="cb7-520"><a href="#cb7-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-523"><a href="#cb7-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-524"><a href="#cb7-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: complementarity-loss</span></span>
<span id="cb7-525"><a href="#cb7-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Complementarity Loss Function Behavior"</span></span>
<span id="cb7-526"><a href="#cb7-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-527"><a href="#cb7-527" aria-hidden="true" tabindex="-1"></a>correlation_values <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb7-528"><a href="#cb7-528" aria-hidden="true" tabindex="-1"></a>loss_values <span class="op">=</span> (correlation_values <span class="op">+</span> <span class="fl">1.0</span>)  <span class="co"># Shift: -1 -&gt; 0, +1 -&gt; 2</span></span>
<span id="cb7-529"><a href="#cb7-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-530"><a href="#cb7-530" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-531"><a href="#cb7-531" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>correlation_values, y<span class="op">=</span>loss_values,</span>
<span id="cb7-532"><a href="#cb7-532" aria-hidden="true" tabindex="-1"></a>                         mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Loss'</span>,</span>
<span id="cb7-533"><a href="#cb7-533" aria-hidden="true" tabindex="-1"></a>                         line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>, width<span class="op">=</span><span class="dv">3</span>)))</span>
<span id="cb7-534"><a href="#cb7-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-535"><a href="#cb7-535" aria-hidden="true" tabindex="-1"></a>fig.add_vline(x<span class="op">=</span><span class="dv">0</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"gray"</span>, annotation_text<span class="op">=</span><span class="st">"No Correlation"</span>)</span>
<span id="cb7-536"><a href="#cb7-536" aria-hidden="true" tabindex="-1"></a>fig.add_vline(x<span class="op">=-</span><span class="fl">0.5</span>, line_dash<span class="op">=</span><span class="st">"dash"</span>, line_color<span class="op">=</span><span class="st">"green"</span>, annotation_text<span class="op">=</span><span class="st">"Target"</span>)</span>
<span id="cb7-537"><a href="#cb7-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-538"><a href="#cb7-538" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Complementarity Loss vs Correlation'</span>,</span>
<span id="cb7-539"><a href="#cb7-539" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Correlation Coefficient'</span>,</span>
<span id="cb7-540"><a href="#cb7-540" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Loss Value'</span>,</span>
<span id="cb7-541"><a href="#cb7-541" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-542"><a href="#cb7-542" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-543"><a href="#cb7-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-544"><a href="#cb7-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-545"><a href="#cb7-545" aria-hidden="true" tabindex="-1"></a>Mathematical formulation:</span>
<span id="cb7-546"><a href="#cb7-546" aria-hidden="true" tabindex="-1"></a>$$\mathcal{L}_{comp} = \frac{1}{|C|} \sum_{i,j \in C} (\rho_{ij} + 1) \cdot S_i^T S_j$$</span>
<span id="cb7-547"><a href="#cb7-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-548"><a href="#cb7-548" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb7-549"><a href="#cb7-549" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\rho_{ij}$: Temporal correlation between nodes $i$ and $j$</span>
<span id="cb7-550"><a href="#cb7-550" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$S$: Soft cluster assignment matrix</span>
<span id="cb7-551"><a href="#cb7-551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$C$: Set of node pairs in same cluster</span>
<span id="cb7-552"><a href="#cb7-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-553"><a href="#cb7-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2 Energy Balance Loss</span></span>
<span id="cb7-554"><a href="#cb7-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-555"><a href="#cb7-555" aria-hidden="true" tabindex="-1"></a>Ensures energy conservation within communities:</span>
<span id="cb7-556"><a href="#cb7-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-557"><a href="#cb7-557" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb7-558"><a href="#cb7-558" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EnergyBalanceLoss(nn.Module):</span>
<span id="cb7-559"><a href="#cb7-559" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _energy_balance_loss(<span class="va">self</span>, energy_sharing, consumption, generation):</span>
<span id="cb7-560"><a href="#cb7-560" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Energy balance: consumption = generation + net_import"""</span></span>
<span id="cb7-561"><a href="#cb7-561" aria-hidden="true" tabindex="-1"></a>        net_demand <span class="op">=</span> consumption <span class="op">-</span> generation</span>
<span id="cb7-562"><a href="#cb7-562" aria-hidden="true" tabindex="-1"></a>        net_import <span class="op">=</span> energy_sharing.<span class="bu">sum</span>(dim<span class="op">=-</span><span class="dv">2</span>) <span class="op">-</span> energy_sharing.<span class="bu">sum</span>(dim<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb7-563"><a href="#cb7-563" aria-hidden="true" tabindex="-1"></a>        imbalance <span class="op">=</span> net_demand <span class="op">-</span> net_import</span>
<span id="cb7-564"><a href="#cb7-564" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (imbalance <span class="op">**</span> <span class="dv">2</span>).mean()</span>
<span id="cb7-565"><a href="#cb7-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-566"><a href="#cb7-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-567"><a href="#cb7-567" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.3 Peak Reduction Loss</span></span>
<span id="cb7-568"><a href="#cb7-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-571"><a href="#cb7-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-572"><a href="#cb7-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: peak-reduction</span></span>
<span id="cb7-573"><a href="#cb7-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Peak Reduction Through Clustering"</span></span>
<span id="cb7-574"><a href="#cb7-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-575"><a href="#cb7-575" aria-hidden="true" tabindex="-1"></a>hours <span class="op">=</span> np.arange(<span class="dv">24</span>)</span>
<span id="cb7-576"><a href="#cb7-576" aria-hidden="true" tabindex="-1"></a>individual_peaks <span class="op">=</span> []</span>
<span id="cb7-577"><a href="#cb7-577" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb7-578"><a href="#cb7-578" aria-hidden="true" tabindex="-1"></a>    peak <span class="op">=</span> np.random.normal(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="dv">24</span>)</span>
<span id="cb7-579"><a href="#cb7-579" aria-hidden="true" tabindex="-1"></a>    peak[<span class="dv">7</span>:<span class="dv">9</span>] <span class="op">+=</span> <span class="fl">1.5</span>  <span class="co"># Morning peak</span></span>
<span id="cb7-580"><a href="#cb7-580" aria-hidden="true" tabindex="-1"></a>    peak[<span class="dv">17</span>:<span class="dv">20</span>] <span class="op">+=</span> <span class="fl">2.0</span>  <span class="co"># Evening peak</span></span>
<span id="cb7-581"><a href="#cb7-581" aria-hidden="true" tabindex="-1"></a>    individual_peaks.append(peak)</span>
<span id="cb7-582"><a href="#cb7-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-583"><a href="#cb7-583" aria-hidden="true" tabindex="-1"></a>aggregated <span class="op">=</span> np.mean(individual_peaks, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb7-584"><a href="#cb7-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-585"><a href="#cb7-585" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-586"><a href="#cb7-586" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, peak <span class="kw">in</span> <span class="bu">enumerate</span>(individual_peaks):</span>
<span id="cb7-587"><a href="#cb7-587" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Scatter(x<span class="op">=</span>hours, y<span class="op">=</span>peak, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb7-588"><a href="#cb7-588" aria-hidden="true" tabindex="-1"></a>                            name<span class="op">=</span><span class="ss">f'Building </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>, opacity<span class="op">=</span><span class="fl">0.3</span>))</span>
<span id="cb7-589"><a href="#cb7-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-590"><a href="#cb7-590" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>hours, y<span class="op">=</span>aggregated, mode<span class="op">=</span><span class="st">'lines'</span>,</span>
<span id="cb7-591"><a href="#cb7-591" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Aggregated'</span>, line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'red'</span>, width<span class="op">=</span><span class="dv">3</span>)))</span>
<span id="cb7-592"><a href="#cb7-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-593"><a href="#cb7-593" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Peak Demand Reduction through Aggregation'</span>,</span>
<span id="cb7-594"><a href="#cb7-594" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Hour'</span>,</span>
<span id="cb7-595"><a href="#cb7-595" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Demand (kW)'</span>,</span>
<span id="cb7-596"><a href="#cb7-596" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-597"><a href="#cb7-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-598"><a href="#cb7-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Add annotation</span></span>
<span id="cb7-599"><a href="#cb7-599" aria-hidden="true" tabindex="-1"></a>max_individual <span class="op">=</span> np.<span class="bu">max</span>([np.<span class="bu">max</span>(p) <span class="cf">for</span> p <span class="kw">in</span> individual_peaks])</span>
<span id="cb7-600"><a href="#cb7-600" aria-hidden="true" tabindex="-1"></a>max_aggregated <span class="op">=</span> np.<span class="bu">max</span>(aggregated)</span>
<span id="cb7-601"><a href="#cb7-601" aria-hidden="true" tabindex="-1"></a>reduction <span class="op">=</span> (max_individual <span class="op">-</span> max_aggregated) <span class="op">/</span> max_individual <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb7-602"><a href="#cb7-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-603"><a href="#cb7-603" aria-hidden="true" tabindex="-1"></a>fig.add_annotation(text<span class="op">=</span><span class="ss">f'Peak Reduction: </span><span class="sc">{</span>reduction<span class="sc">:.1f}</span><span class="ss">%'</span>,</span>
<span id="cb7-604"><a href="#cb7-604" aria-hidden="true" tabindex="-1"></a>                  xref<span class="op">=</span><span class="st">"paper"</span>, yref<span class="op">=</span><span class="st">"paper"</span>,</span>
<span id="cb7-605"><a href="#cb7-605" aria-hidden="true" tabindex="-1"></a>                  x<span class="op">=</span><span class="fl">0.02</span>, y<span class="op">=</span><span class="fl">0.98</span>, showarrow<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb7-606"><a href="#cb7-606" aria-hidden="true" tabindex="-1"></a>                  bgcolor<span class="op">=</span><span class="st">"white"</span>, bordercolor<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb7-607"><a href="#cb7-607" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-608"><a href="#cb7-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-609"><a href="#cb7-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-610"><a href="#cb7-610" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4 Unified Loss Function</span></span>
<span id="cb7-611"><a href="#cb7-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-612"><a href="#cb7-612" aria-hidden="true" tabindex="-1"></a>Combines all objectives:</span>
<span id="cb7-613"><a href="#cb7-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-616"><a href="#cb7-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-617"><a href="#cb7-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: loss-composition</span></span>
<span id="cb7-618"><a href="#cb7-618" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Loss Function Component Weights"</span></span>
<span id="cb7-619"><a href="#cb7-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-620"><a href="#cb7-620" aria-hidden="true" tabindex="-1"></a>loss_components <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-621"><a href="#cb7-621" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Component'</span>: [<span class="st">'Complementarity'</span>, <span class="st">'Physics'</span>, <span class="st">'Peak Reduction'</span>, </span>
<span id="cb7-622"><a href="#cb7-622" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Self-Sufficiency'</span>, <span class="st">'Cluster Quality'</span>],</span>
<span id="cb7-623"><a href="#cb7-623" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Weight'</span>: [<span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">0.65</span>, <span class="fl">1.5</span>],</span>
<span id="cb7-624"><a href="#cb7-624" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Category'</span>: [<span class="st">'Pattern'</span>, <span class="st">'Constraint'</span>, <span class="st">'Objective'</span>, <span class="st">'Objective'</span>, <span class="st">'Structure'</span>]</span>
<span id="cb7-625"><a href="#cb7-625" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-626"><a href="#cb7-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-627"><a href="#cb7-627" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.pie(loss_components, values<span class="op">=</span><span class="st">'Weight'</span>, names<span class="op">=</span><span class="st">'Component'</span>,</span>
<span id="cb7-628"><a href="#cb7-628" aria-hidden="true" tabindex="-1"></a>             color<span class="op">=</span><span class="st">'Category'</span>, title<span class="op">=</span><span class="st">'Unified Loss Function Composition'</span>)</span>
<span id="cb7-629"><a href="#cb7-629" aria-hidden="true" tabindex="-1"></a>fig.update_traces(textposition<span class="op">=</span><span class="st">'inside'</span>, textinfo<span class="op">=</span><span class="st">'percent+label'</span>)</span>
<span id="cb7-630"><a href="#cb7-630" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-631"><a href="#cb7-631" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-632"><a href="#cb7-632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-633"><a href="#cb7-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-634"><a href="#cb7-634" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-635"><a href="#cb7-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-636"><a href="#cb7-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Training Strategies</span></span>
<span id="cb7-637"><a href="#cb7-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-638"><a href="#cb7-638" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.1 Optimization Techniques</span></span>
<span id="cb7-639"><a href="#cb7-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-642"><a href="#cb7-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-643"><a href="#cb7-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: optimization-comparison</span></span>
<span id="cb7-644"><a href="#cb7-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Optimizer Performance Comparison"</span></span>
<span id="cb7-645"><a href="#cb7-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-646"><a href="#cb7-646" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb7-647"><a href="#cb7-647" aria-hidden="true" tabindex="-1"></a>adam_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">20</span>) <span class="op">+</span> <span class="fl">0.1</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.02</span>, <span class="dv">100</span>)</span>
<span id="cb7-648"><a href="#cb7-648" aria-hidden="true" tabindex="-1"></a>adamw_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">15</span>) <span class="op">+</span> <span class="fl">0.08</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.015</span>, <span class="dv">100</span>)</span>
<span id="cb7-649"><a href="#cb7-649" aria-hidden="true" tabindex="-1"></a>sgd_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">30</span>) <span class="op">+</span> <span class="fl">0.12</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">100</span>)</span>
<span id="cb7-650"><a href="#cb7-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-651"><a href="#cb7-651" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-652"><a href="#cb7-652" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>adam_loss, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Adam'</span>))</span>
<span id="cb7-653"><a href="#cb7-653" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>adamw_loss, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'AdamW'</span>))</span>
<span id="cb7-654"><a href="#cb7-654" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>sgd_loss, mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'SGD'</span>))</span>
<span id="cb7-655"><a href="#cb7-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-656"><a href="#cb7-656" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Optimizer Convergence Comparison'</span>,</span>
<span id="cb7-657"><a href="#cb7-657" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Epoch'</span>,</span>
<span id="cb7-658"><a href="#cb7-658" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Loss'</span>,</span>
<span id="cb7-659"><a href="#cb7-659" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-660"><a href="#cb7-660" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-661"><a href="#cb7-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-662"><a href="#cb7-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-663"><a href="#cb7-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.2 Learning Rate Scheduling</span></span>
<span id="cb7-664"><a href="#cb7-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-667"><a href="#cb7-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-668"><a href="#cb7-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lr-scheduling</span></span>
<span id="cb7-669"><a href="#cb7-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Learning Rate Schedule Strategies"</span></span>
<span id="cb7-670"><a href="#cb7-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-671"><a href="#cb7-671" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb7-672"><a href="#cb7-672" aria-hidden="true" tabindex="-1"></a>cosine_lr <span class="op">=</span> <span class="fl">0.001</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> np.cos(np.pi <span class="op">*</span> epochs <span class="op">/</span> <span class="dv">100</span>)) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb7-673"><a href="#cb7-673" aria-hidden="true" tabindex="-1"></a>plateau_lr <span class="op">=</span> <span class="fl">0.001</span> <span class="op">*</span> np.ones(<span class="dv">100</span>)</span>
<span id="cb7-674"><a href="#cb7-674" aria-hidden="true" tabindex="-1"></a>plateau_lr[<span class="dv">30</span>:] <span class="op">*=</span> <span class="fl">0.5</span></span>
<span id="cb7-675"><a href="#cb7-675" aria-hidden="true" tabindex="-1"></a>plateau_lr[<span class="dv">60</span>:] <span class="op">*=</span> <span class="fl">0.5</span></span>
<span id="cb7-676"><a href="#cb7-676" aria-hidden="true" tabindex="-1"></a>plateau_lr[<span class="dv">80</span>:] <span class="op">*=</span> <span class="fl">0.5</span></span>
<span id="cb7-677"><a href="#cb7-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-678"><a href="#cb7-678" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-679"><a href="#cb7-679" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>cosine_lr, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-680"><a href="#cb7-680" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Cosine Annealing'</span>))</span>
<span id="cb7-681"><a href="#cb7-681" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>plateau_lr, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-682"><a href="#cb7-682" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Reduce on Plateau'</span>))</span>
<span id="cb7-683"><a href="#cb7-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-684"><a href="#cb7-684" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Learning Rate Scheduling Strategies'</span>,</span>
<span id="cb7-685"><a href="#cb7-685" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Epoch'</span>,</span>
<span id="cb7-686"><a href="#cb7-686" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Learning Rate'</span>,</span>
<span id="cb7-687"><a href="#cb7-687" aria-hidden="true" tabindex="-1"></a>                  yaxis_type<span class="op">=</span><span class="st">'log'</span>,</span>
<span id="cb7-688"><a href="#cb7-688" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-689"><a href="#cb7-689" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-690"><a href="#cb7-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-691"><a href="#cb7-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-692"><a href="#cb7-692" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.3 Training Pipeline Integration</span></span>
<span id="cb7-693"><a href="#cb7-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-696"><a href="#cb7-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb7-697"><a href="#cb7-697" aria-hidden="true" tabindex="-1"></a>sequenceDiagram</span>
<span id="cb7-698"><a href="#cb7-698" aria-hidden="true" tabindex="-1"></a>    participant D as Data Loader</span>
<span id="cb7-699"><a href="#cb7-699" aria-hidden="true" tabindex="-1"></a>    participant T as Trainer</span>
<span id="cb7-700"><a href="#cb7-700" aria-hidden="true" tabindex="-1"></a>    participant M as Model</span>
<span id="cb7-701"><a href="#cb7-701" aria-hidden="true" tabindex="-1"></a>    participant L as Loss Functions</span>
<span id="cb7-702"><a href="#cb7-702" aria-hidden="true" tabindex="-1"></a>    participant O as Optimizer</span>
<span id="cb7-703"><a href="#cb7-703" aria-hidden="true" tabindex="-1"></a>    participant V as Validator</span>
<span id="cb7-704"><a href="#cb7-704" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-705"><a href="#cb7-705" aria-hidden="true" tabindex="-1"></a>    D-&gt;&gt;T: Batch of graphs</span>
<span id="cb7-706"><a href="#cb7-706" aria-hidden="true" tabindex="-1"></a>    T-&gt;&gt;M: Forward pass</span>
<span id="cb7-707"><a href="#cb7-707" aria-hidden="true" tabindex="-1"></a>    M-&gt;&gt;M: Attention layers</span>
<span id="cb7-708"><a href="#cb7-708" aria-hidden="true" tabindex="-1"></a>    M-&gt;&gt;M: Physics constraints</span>
<span id="cb7-709"><a href="#cb7-709" aria-hidden="true" tabindex="-1"></a>    M-&gt;&gt;M: Pooling/Clustering</span>
<span id="cb7-710"><a href="#cb7-710" aria-hidden="true" tabindex="-1"></a>    M-&gt;&gt;T: Predictions</span>
<span id="cb7-711"><a href="#cb7-711" aria-hidden="true" tabindex="-1"></a>    T-&gt;&gt;L: Calculate losses</span>
<span id="cb7-712"><a href="#cb7-712" aria-hidden="true" tabindex="-1"></a>    L-&gt;&gt;L: Complementarity</span>
<span id="cb7-713"><a href="#cb7-713" aria-hidden="true" tabindex="-1"></a>    L-&gt;&gt;L: Energy balance</span>
<span id="cb7-714"><a href="#cb7-714" aria-hidden="true" tabindex="-1"></a>    L-&gt;&gt;L: Peak reduction</span>
<span id="cb7-715"><a href="#cb7-715" aria-hidden="true" tabindex="-1"></a>    L-&gt;&gt;T: Total loss</span>
<span id="cb7-716"><a href="#cb7-716" aria-hidden="true" tabindex="-1"></a>    T-&gt;&gt;O: Backward pass</span>
<span id="cb7-717"><a href="#cb7-717" aria-hidden="true" tabindex="-1"></a>    O-&gt;&gt;M: Update weights</span>
<span id="cb7-718"><a href="#cb7-718" aria-hidden="true" tabindex="-1"></a>    T-&gt;&gt;V: Validate</span>
<span id="cb7-719"><a href="#cb7-719" aria-hidden="true" tabindex="-1"></a>    V-&gt;&gt;T: Metrics</span>
<span id="cb7-720"><a href="#cb7-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-721"><a href="#cb7-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-722"><a href="#cb7-722" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-723"><a href="#cb7-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-724"><a href="#cb7-724" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Performance Metrics</span></span>
<span id="cb7-725"><a href="#cb7-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-726"><a href="#cb7-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1 Key Performance Indicators</span></span>
<span id="cb7-727"><a href="#cb7-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-730"><a href="#cb7-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-731"><a href="#cb7-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: kpi-dashboard</span></span>
<span id="cb7-732"><a href="#cb7-732" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "System Performance Dashboard"</span></span>
<span id="cb7-733"><a href="#cb7-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-734"><a href="#cb7-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Create KPI dashboard</span></span>
<span id="cb7-735"><a href="#cb7-735" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> make_subplots(</span>
<span id="cb7-736"><a href="#cb7-736" aria-hidden="true" tabindex="-1"></a>    rows<span class="op">=</span><span class="dv">2</span>, cols<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb7-737"><a href="#cb7-737" aria-hidden="true" tabindex="-1"></a>    subplot_titles<span class="op">=</span>(<span class="st">'Self-Sufficiency'</span>, <span class="st">'Peak Reduction'</span>, </span>
<span id="cb7-738"><a href="#cb7-738" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'Complementarity Score'</span>, <span class="st">'Network Efficiency'</span>),</span>
<span id="cb7-739"><a href="#cb7-739" aria-hidden="true" tabindex="-1"></a>    specs<span class="op">=</span>[[{<span class="st">'type'</span>: <span class="st">'indicator'</span>}, {<span class="st">'type'</span>: <span class="st">'indicator'</span>}],</span>
<span id="cb7-740"><a href="#cb7-740" aria-hidden="true" tabindex="-1"></a>           [{<span class="st">'type'</span>: <span class="st">'indicator'</span>}, {<span class="st">'type'</span>: <span class="st">'indicator'</span>}]]</span>
<span id="cb7-741"><a href="#cb7-741" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-742"><a href="#cb7-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-743"><a href="#cb7-743" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Indicator(</span>
<span id="cb7-744"><a href="#cb7-744" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"gauge+number"</span>,</span>
<span id="cb7-745"><a href="#cb7-745" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="dv">72</span>,</span>
<span id="cb7-746"><a href="#cb7-746" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{<span class="st">'text'</span>: <span class="st">"Self-Sufficiency (%)"</span>},</span>
<span id="cb7-747"><a href="#cb7-747" aria-hidden="true" tabindex="-1"></a>    domain<span class="op">=</span>{<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'y'</span>: [<span class="dv">0</span>, <span class="dv">1</span>]},</span>
<span id="cb7-748"><a href="#cb7-748" aria-hidden="true" tabindex="-1"></a>    gauge<span class="op">=</span>{<span class="st">'axis'</span>: {<span class="st">'range'</span>: [<span class="va">None</span>, <span class="dv">100</span>]},</span>
<span id="cb7-749"><a href="#cb7-749" aria-hidden="true" tabindex="-1"></a>           <span class="st">'bar'</span>: {<span class="st">'color'</span>: <span class="st">"darkgreen"</span>},</span>
<span id="cb7-750"><a href="#cb7-750" aria-hidden="true" tabindex="-1"></a>           <span class="st">'threshold'</span>: {<span class="st">'value'</span>: <span class="dv">65</span>, <span class="st">'thickness'</span>: <span class="fl">0.75</span>}}</span>
<span id="cb7-751"><a href="#cb7-751" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-752"><a href="#cb7-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-753"><a href="#cb7-753" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Indicator(</span>
<span id="cb7-754"><a href="#cb7-754" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"gauge+number"</span>,</span>
<span id="cb7-755"><a href="#cb7-755" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="dv">28</span>,</span>
<span id="cb7-756"><a href="#cb7-756" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{<span class="st">'text'</span>: <span class="st">"Peak Reduction (%)"</span>},</span>
<span id="cb7-757"><a href="#cb7-757" aria-hidden="true" tabindex="-1"></a>    domain<span class="op">=</span>{<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'y'</span>: [<span class="dv">0</span>, <span class="dv">1</span>]},</span>
<span id="cb7-758"><a href="#cb7-758" aria-hidden="true" tabindex="-1"></a>    gauge<span class="op">=</span>{<span class="st">'axis'</span>: {<span class="st">'range'</span>: [<span class="va">None</span>, <span class="dv">50</span>]},</span>
<span id="cb7-759"><a href="#cb7-759" aria-hidden="true" tabindex="-1"></a>           <span class="st">'bar'</span>: {<span class="st">'color'</span>: <span class="st">"blue"</span>},</span>
<span id="cb7-760"><a href="#cb7-760" aria-hidden="true" tabindex="-1"></a>           <span class="st">'threshold'</span>: {<span class="st">'value'</span>: <span class="dv">25</span>, <span class="st">'thickness'</span>: <span class="fl">0.75</span>}}</span>
<span id="cb7-761"><a href="#cb7-761" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">1</span>, col<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-762"><a href="#cb7-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-763"><a href="#cb7-763" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Indicator(</span>
<span id="cb7-764"><a href="#cb7-764" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"gauge+number"</span>,</span>
<span id="cb7-765"><a href="#cb7-765" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=-</span><span class="fl">0.65</span>,</span>
<span id="cb7-766"><a href="#cb7-766" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{<span class="st">'text'</span>: <span class="st">"Avg Correlation"</span>},</span>
<span id="cb7-767"><a href="#cb7-767" aria-hidden="true" tabindex="-1"></a>    domain<span class="op">=</span>{<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'y'</span>: [<span class="dv">0</span>, <span class="dv">1</span>]},</span>
<span id="cb7-768"><a href="#cb7-768" aria-hidden="true" tabindex="-1"></a>    gauge<span class="op">=</span>{<span class="st">'axis'</span>: {<span class="st">'range'</span>: [<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>]},</span>
<span id="cb7-769"><a href="#cb7-769" aria-hidden="true" tabindex="-1"></a>           <span class="st">'bar'</span>: {<span class="st">'color'</span>: <span class="st">"purple"</span>},</span>
<span id="cb7-770"><a href="#cb7-770" aria-hidden="true" tabindex="-1"></a>           <span class="st">'threshold'</span>: {<span class="st">'value'</span>: <span class="op">-</span><span class="fl">0.5</span>, <span class="st">'thickness'</span>: <span class="fl">0.75</span>}}</span>
<span id="cb7-771"><a href="#cb7-771" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-772"><a href="#cb7-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-773"><a href="#cb7-773" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Indicator(</span>
<span id="cb7-774"><a href="#cb7-774" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">"gauge+number"</span>,</span>
<span id="cb7-775"><a href="#cb7-775" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="dv">94</span>,</span>
<span id="cb7-776"><a href="#cb7-776" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span>{<span class="st">'text'</span>: <span class="st">"Network Efficiency (%)"</span>},</span>
<span id="cb7-777"><a href="#cb7-777" aria-hidden="true" tabindex="-1"></a>    domain<span class="op">=</span>{<span class="st">'x'</span>: [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'y'</span>: [<span class="dv">0</span>, <span class="dv">1</span>]},</span>
<span id="cb7-778"><a href="#cb7-778" aria-hidden="true" tabindex="-1"></a>    gauge<span class="op">=</span>{<span class="st">'axis'</span>: {<span class="st">'range'</span>: [<span class="va">None</span>, <span class="dv">100</span>]},</span>
<span id="cb7-779"><a href="#cb7-779" aria-hidden="true" tabindex="-1"></a>           <span class="st">'bar'</span>: {<span class="st">'color'</span>: <span class="st">"orange"</span>},</span>
<span id="cb7-780"><a href="#cb7-780" aria-hidden="true" tabindex="-1"></a>           <span class="st">'threshold'</span>: {<span class="st">'value'</span>: <span class="dv">90</span>, <span class="st">'thickness'</span>: <span class="fl">0.75</span>}}</span>
<span id="cb7-781"><a href="#cb7-781" aria-hidden="true" tabindex="-1"></a>), row<span class="op">=</span><span class="dv">2</span>, col<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-782"><a href="#cb7-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-783"><a href="#cb7-783" aria-hidden="true" tabindex="-1"></a>fig.update_layout(height<span class="op">=</span><span class="dv">600</span>, title_text<span class="op">=</span><span class="st">"Energy GNN Performance Metrics"</span>)</span>
<span id="cb7-784"><a href="#cb7-784" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-785"><a href="#cb7-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-786"><a href="#cb7-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-787"><a href="#cb7-787" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2 Training Convergence Analysis</span></span>
<span id="cb7-788"><a href="#cb7-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-791"><a href="#cb7-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-792"><a href="#cb7-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: convergence-analysis</span></span>
<span id="cb7-793"><a href="#cb7-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Multi-Component Loss Convergence"</span></span>
<span id="cb7-794"><a href="#cb7-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-795"><a href="#cb7-795" aria-hidden="true" tabindex="-1"></a>epochs <span class="op">=</span> np.arange(<span class="dv">50</span>)</span>
<span id="cb7-796"><a href="#cb7-796" aria-hidden="true" tabindex="-1"></a>comp_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">10</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="dv">50</span>)</span>
<span id="cb7-797"><a href="#cb7-797" aria-hidden="true" tabindex="-1"></a>phys_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">15</span>) <span class="op">+</span> <span class="fl">0.2</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">50</span>)</span>
<span id="cb7-798"><a href="#cb7-798" aria-hidden="true" tabindex="-1"></a>peak_loss <span class="op">=</span> np.exp(<span class="op">-</span>epochs<span class="op">/</span><span class="dv">12</span>) <span class="op">*</span> <span class="fl">0.8</span> <span class="op">+</span> <span class="fl">0.15</span> <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.02</span>, <span class="dv">50</span>)</span>
<span id="cb7-799"><a href="#cb7-799" aria-hidden="true" tabindex="-1"></a>total_loss <span class="op">=</span> (comp_loss <span class="op">+</span> phys_loss <span class="op">+</span> peak_loss) <span class="op">/</span> <span class="dv">3</span></span>
<span id="cb7-800"><a href="#cb7-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-801"><a href="#cb7-801" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-802"><a href="#cb7-802" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>comp_loss, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-803"><a href="#cb7-803" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Complementarity'</span>, line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">2</span>)))</span>
<span id="cb7-804"><a href="#cb7-804" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>phys_loss, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-805"><a href="#cb7-805" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Physics'</span>, line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">2</span>)))</span>
<span id="cb7-806"><a href="#cb7-806" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>peak_loss, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-807"><a href="#cb7-807" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Peak Reduction'</span>, line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">2</span>)))</span>
<span id="cb7-808"><a href="#cb7-808" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(x<span class="op">=</span>epochs, y<span class="op">=</span>total_loss, mode<span class="op">=</span><span class="st">'lines'</span>, </span>
<span id="cb7-809"><a href="#cb7-809" aria-hidden="true" tabindex="-1"></a>                        name<span class="op">=</span><span class="st">'Total'</span>, line<span class="op">=</span><span class="bu">dict</span>(width<span class="op">=</span><span class="dv">3</span>, dash<span class="op">=</span><span class="st">'dash'</span>)))</span>
<span id="cb7-810"><a href="#cb7-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-811"><a href="#cb7-811" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Training Loss Convergence'</span>,</span>
<span id="cb7-812"><a href="#cb7-812" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Epoch'</span>,</span>
<span id="cb7-813"><a href="#cb7-813" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Loss Value'</span>,</span>
<span id="cb7-814"><a href="#cb7-814" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-815"><a href="#cb7-815" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-816"><a href="#cb7-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-817"><a href="#cb7-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-818"><a href="#cb7-818" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-819"><a href="#cb7-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-820"><a href="#cb7-820" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7. Component Interactions</span></span>
<span id="cb7-821"><a href="#cb7-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-822"><a href="#cb7-822" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1 Information Flow</span></span>
<span id="cb7-823"><a href="#cb7-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-826"><a href="#cb7-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb7-827"><a href="#cb7-827" aria-hidden="true" tabindex="-1"></a>graph LR</span>
<span id="cb7-828"><a href="#cb7-828" aria-hidden="true" tabindex="-1"></a>    subgraph Input Processing</span>
<span id="cb7-829"><a href="#cb7-829" aria-hidden="true" tabindex="-1"></a>        IF[Input Features] --&gt; TA[Temporal Attention]</span>
<span id="cb7-830"><a href="#cb7-830" aria-hidden="true" tabindex="-1"></a>        IF --&gt; CA[Complementarity Attention]</span>
<span id="cb7-831"><a href="#cb7-831" aria-hidden="true" tabindex="-1"></a>        IF --&gt; SA[Spatial Attention]</span>
<span id="cb7-832"><a href="#cb7-832" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-833"><a href="#cb7-833" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-834"><a href="#cb7-834" aria-hidden="true" tabindex="-1"></a>    subgraph Core Processing</span>
<span id="cb7-835"><a href="#cb7-835" aria-hidden="true" tabindex="-1"></a>        TA --&gt; UAM[Unified Attention Module]</span>
<span id="cb7-836"><a href="#cb7-836" aria-hidden="true" tabindex="-1"></a>        CA --&gt; UAM</span>
<span id="cb7-837"><a href="#cb7-837" aria-hidden="true" tabindex="-1"></a>        SA --&gt; UAM</span>
<span id="cb7-838"><a href="#cb7-838" aria-hidden="true" tabindex="-1"></a>        UAM --&gt; PL[Physics Layers]</span>
<span id="cb7-839"><a href="#cb7-839" aria-hidden="true" tabindex="-1"></a>        PL --&gt; DP[DiffPool]</span>
<span id="cb7-840"><a href="#cb7-840" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-841"><a href="#cb7-841" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-842"><a href="#cb7-842" aria-hidden="true" tabindex="-1"></a>    subgraph Output Generation</span>
<span id="cb7-843"><a href="#cb7-843" aria-hidden="true" tabindex="-1"></a>        DP --&gt; CL[Cluster Assignments]</span>
<span id="cb7-844"><a href="#cb7-844" aria-hidden="true" tabindex="-1"></a>        DP --&gt; EF[Energy Flows]</span>
<span id="cb7-845"><a href="#cb7-845" aria-hidden="true" tabindex="-1"></a>        CL --&gt; IM[Intervention Module]</span>
<span id="cb7-846"><a href="#cb7-846" aria-hidden="true" tabindex="-1"></a>        EF --&gt; IM</span>
<span id="cb7-847"><a href="#cb7-847" aria-hidden="true" tabindex="-1"></a>        IM --&gt; CP[Cascade Predictor]</span>
<span id="cb7-848"><a href="#cb7-848" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb7-849"><a href="#cb7-849" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-850"><a href="#cb7-850" aria-hidden="true" tabindex="-1"></a>    style IF fill:<span class="co">#e6f2ff</span></span>
<span id="cb7-851"><a href="#cb7-851" aria-hidden="true" tabindex="-1"></a>    style UAM fill:<span class="co">#fff0e6</span></span>
<span id="cb7-852"><a href="#cb7-852" aria-hidden="true" tabindex="-1"></a>    style IM fill:<span class="co">#ffe6e6</span></span>
<span id="cb7-853"><a href="#cb7-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-854"><a href="#cb7-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-855"><a href="#cb7-855" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2 Trainer-Layer-Loss Relationships</span></span>
<span id="cb7-856"><a href="#cb7-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-859"><a href="#cb7-859" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-860"><a href="#cb7-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: component-relationships</span></span>
<span id="cb7-861"><a href="#cb7-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Component Dependency Matrix"</span></span>
<span id="cb7-862"><a href="#cb7-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-863"><a href="#cb7-863" aria-hidden="true" tabindex="-1"></a>components_trainers <span class="op">=</span> [<span class="st">'Discovery'</span>, <span class="st">'Network-Aware'</span>, <span class="st">'Unified'</span>, <span class="st">'Enhanced'</span>]</span>
<span id="cb7-864"><a href="#cb7-864" aria-hidden="true" tabindex="-1"></a>components_layers <span class="op">=</span> [<span class="st">'Attention'</span>, <span class="st">'Temporal'</span>, <span class="st">'Physics'</span>, <span class="st">'Pooling'</span>]</span>
<span id="cb7-865"><a href="#cb7-865" aria-hidden="true" tabindex="-1"></a>components_losses <span class="op">=</span> [<span class="st">'Complementarity'</span>, <span class="st">'Balance'</span>, <span class="st">'Peak'</span>, <span class="st">'Quality'</span>]</span>
<span id="cb7-866"><a href="#cb7-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-867"><a href="#cb7-867" aria-hidden="true" tabindex="-1"></a><span class="co"># Create relationship matrix (1 = uses, 0 = doesn't use)</span></span>
<span id="cb7-868"><a href="#cb7-868" aria-hidden="true" tabindex="-1"></a>relationships <span class="op">=</span> np.array([</span>
<span id="cb7-869"><a href="#cb7-869" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],  <span class="co"># Discovery</span></span>
<span id="cb7-870"><a href="#cb7-870" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],  <span class="co"># Network-Aware</span></span>
<span id="cb7-871"><a href="#cb7-871" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>],  <span class="co"># Unified</span></span>
<span id="cb7-872"><a href="#cb7-872" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],  <span class="co"># Enhanced</span></span>
<span id="cb7-873"><a href="#cb7-873" aria-hidden="true" tabindex="-1"></a>]).reshape(<span class="dv">4</span>, <span class="dv">12</span>)</span>
<span id="cb7-874"><a href="#cb7-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-875"><a href="#cb7-875" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>go.Heatmap(</span>
<span id="cb7-876"><a href="#cb7-876" aria-hidden="true" tabindex="-1"></a>    z<span class="op">=</span>relationships,</span>
<span id="cb7-877"><a href="#cb7-877" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>components_layers <span class="op">+</span> components_losses <span class="op">+</span> [<span class="st">'Network'</span>, <span class="st">'Cascade'</span>, <span class="st">'Uncertainty'</span>, <span class="st">'Active'</span>],</span>
<span id="cb7-878"><a href="#cb7-878" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>components_trainers,</span>
<span id="cb7-879"><a href="#cb7-879" aria-hidden="true" tabindex="-1"></a>    colorscale<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb7-880"><a href="#cb7-880" aria-hidden="true" tabindex="-1"></a>    showscale<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb7-881"><a href="#cb7-881" aria-hidden="true" tabindex="-1"></a>    text<span class="op">=</span>relationships,</span>
<span id="cb7-882"><a href="#cb7-882" aria-hidden="true" tabindex="-1"></a>    texttemplate<span class="op">=</span><span class="st">"%</span><span class="sc">{text}</span><span class="st">"</span>,</span>
<span id="cb7-883"><a href="#cb7-883" aria-hidden="true" tabindex="-1"></a>    textfont<span class="op">=</span>{<span class="st">"size"</span>: <span class="dv">12</span>}</span>
<span id="cb7-884"><a href="#cb7-884" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb7-885"><a href="#cb7-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-886"><a href="#cb7-886" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'Trainer-Component Dependency Matrix'</span>,</span>
<span id="cb7-887"><a href="#cb7-887" aria-hidden="true" tabindex="-1"></a>                  xaxis_title<span class="op">=</span><span class="st">'Components'</span>,</span>
<span id="cb7-888"><a href="#cb7-888" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Trainers'</span>,</span>
<span id="cb7-889"><a href="#cb7-889" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-890"><a href="#cb7-890" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-891"><a href="#cb7-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-892"><a href="#cb7-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-893"><a href="#cb7-893" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-894"><a href="#cb7-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-895"><a href="#cb7-895" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8. Innovation Highlights</span></span>
<span id="cb7-896"><a href="#cb7-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-897"><a href="#cb7-897" aria-hidden="true" tabindex="-1"></a><span class="fu">### 8.1 Key Innovations</span></span>
<span id="cb7-898"><a href="#cb7-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-899"><a href="#cb7-899" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb7-900"><a href="#cb7-900" aria-hidden="true" tabindex="-1"></a><span class="fu">## Novel Contributions</span></span>
<span id="cb7-901"><a href="#cb7-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-902"><a href="#cb7-902" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Complementarity-Aware Attention**: First GNN architecture explicitly designed to identify and leverage negative correlation patterns in energy consumption</span>
<span id="cb7-903"><a href="#cb7-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-904"><a href="#cb7-904" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Multi-Hop Cascade Prediction**: Tracks intervention effects through network topology up to 3 hops, quantifying indirect benefits</span>
<span id="cb7-905"><a href="#cb7-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-906"><a href="#cb7-906" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Physics-Constrained Clustering**: DiffPool variant that respects LV group boundaries and transformer capacity constraints</span>
<span id="cb7-907"><a href="#cb7-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-908"><a href="#cb7-908" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Intervention Loop Training**: Active learning through simulated interventions with real-world cascade tracking</span>
<span id="cb7-909"><a href="#cb7-909" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-910"><a href="#cb7-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-911"><a href="#cb7-911" aria-hidden="true" tabindex="-1"></a><span class="fu">### 8.2 Comparison with Baselines</span></span>
<span id="cb7-912"><a href="#cb7-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-915"><a href="#cb7-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-916"><a href="#cb7-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: baseline-comparison</span></span>
<span id="cb7-917"><a href="#cb7-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Performance vs Traditional Methods"</span></span>
<span id="cb7-918"><a href="#cb7-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-919"><a href="#cb7-919" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> [<span class="st">'Random'</span>, <span class="st">'Energy Label'</span>, <span class="st">'Distance-Based'</span>, <span class="st">'Correlation'</span>, <span class="st">'GNN (Ours)'</span>]</span>
<span id="cb7-920"><a href="#cb7-920" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-921"><a href="#cb7-921" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Method'</span>: methods <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb7-922"><a href="#cb7-922" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Self-Sufficiency'</span>] <span class="op">*</span> <span class="dv">5</span> <span class="op">+</span> [<span class="st">'Peak Reduction'</span>] <span class="op">*</span> <span class="dv">5</span> <span class="op">+</span> [<span class="st">'Network Impact'</span>] <span class="op">*</span> <span class="dv">5</span>,</span>
<span id="cb7-923"><a href="#cb7-923" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Value'</span>: [<span class="dv">45</span>, <span class="dv">52</span>, <span class="dv">48</span>, <span class="dv">58</span>, <span class="dv">72</span>,  <span class="co"># Self-sufficiency</span></span>
<span id="cb7-924"><a href="#cb7-924" aria-hidden="true" tabindex="-1"></a>              <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">28</span>,   <span class="co"># Peak reduction</span></span>
<span id="cb7-925"><a href="#cb7-925" aria-hidden="true" tabindex="-1"></a>              <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">45</span>]   <span class="co"># Network impact</span></span>
<span id="cb7-926"><a href="#cb7-926" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-927"><a href="#cb7-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-928"><a href="#cb7-928" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(metrics, x<span class="op">=</span><span class="st">'Method'</span>, y<span class="op">=</span><span class="st">'Value'</span>, color<span class="op">=</span><span class="st">'Metric'</span>,</span>
<span id="cb7-929"><a href="#cb7-929" aria-hidden="true" tabindex="-1"></a>             barmode<span class="op">=</span><span class="st">'group'</span>, title<span class="op">=</span><span class="st">'Performance Comparison: GNN vs Baselines'</span>)</span>
<span id="cb7-930"><a href="#cb7-930" aria-hidden="true" tabindex="-1"></a>fig.update_layout(xaxis_title<span class="op">=</span><span class="st">'Method'</span>,</span>
<span id="cb7-931"><a href="#cb7-931" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Performance (%)'</span>,</span>
<span id="cb7-932"><a href="#cb7-932" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-933"><a href="#cb7-933" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-934"><a href="#cb7-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-935"><a href="#cb7-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-936"><a href="#cb7-936" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-937"><a href="#cb7-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-938"><a href="#cb7-938" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9. Implementation Guidelines</span></span>
<span id="cb7-939"><a href="#cb7-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-940"><a href="#cb7-940" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.1 Configuration Examples</span></span>
<span id="cb7-941"><a href="#cb7-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-942"><a href="#cb7-942" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb7-943"><a href="#cb7-943" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimal configuration for energy community discovery</span></span>
<span id="cb7-944"><a href="#cb7-944" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
<span id="cb7-945"><a href="#cb7-945" aria-hidden="true" tabindex="-1"></a>    <span class="st">'model'</span>: {</span>
<span id="cb7-946"><a href="#cb7-946" aria-hidden="true" tabindex="-1"></a>        <span class="st">'hidden_dim'</span>: <span class="dv">128</span>,</span>
<span id="cb7-947"><a href="#cb7-947" aria-hidden="true" tabindex="-1"></a>        <span class="st">'num_layers'</span>: <span class="dv">3</span>,</span>
<span id="cb7-948"><a href="#cb7-948" aria-hidden="true" tabindex="-1"></a>        <span class="st">'heads'</span>: <span class="dv">8</span>,</span>
<span id="cb7-949"><a href="#cb7-949" aria-hidden="true" tabindex="-1"></a>        <span class="st">'dropout'</span>: <span class="fl">0.1</span></span>
<span id="cb7-950"><a href="#cb7-950" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb7-951"><a href="#cb7-951" aria-hidden="true" tabindex="-1"></a>    <span class="st">'training'</span>: {</span>
<span id="cb7-952"><a href="#cb7-952" aria-hidden="true" tabindex="-1"></a>        <span class="st">'learning_rate'</span>: <span class="fl">1e-3</span>,</span>
<span id="cb7-953"><a href="#cb7-953" aria-hidden="true" tabindex="-1"></a>        <span class="st">'weight_decay'</span>: <span class="fl">1e-4</span>,</span>
<span id="cb7-954"><a href="#cb7-954" aria-hidden="true" tabindex="-1"></a>        <span class="st">'epochs'</span>: <span class="dv">100</span>,</span>
<span id="cb7-955"><a href="#cb7-955" aria-hidden="true" tabindex="-1"></a>        <span class="st">'batch_size'</span>: <span class="dv">32</span></span>
<span id="cb7-956"><a href="#cb7-956" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb7-957"><a href="#cb7-957" aria-hidden="true" tabindex="-1"></a>    <span class="st">'loss'</span>: {</span>
<span id="cb7-958"><a href="#cb7-958" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_complementarity'</span>: <span class="fl">2.0</span>,</span>
<span id="cb7-959"><a href="#cb7-959" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_physics'</span>: <span class="fl">1.0</span>,</span>
<span id="cb7-960"><a href="#cb7-960" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_peak'</span>: <span class="fl">1.0</span>,</span>
<span id="cb7-961"><a href="#cb7-961" aria-hidden="true" tabindex="-1"></a>        <span class="st">'alpha_quality'</span>: <span class="fl">1.5</span></span>
<span id="cb7-962"><a href="#cb7-962" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb7-963"><a href="#cb7-963" aria-hidden="true" tabindex="-1"></a>    <span class="st">'clustering'</span>: {</span>
<span id="cb7-964"><a href="#cb7-964" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_clusters'</span>: <span class="dv">20</span>,</span>
<span id="cb7-965"><a href="#cb7-965" aria-hidden="true" tabindex="-1"></a>        <span class="st">'min_cluster_size'</span>: <span class="dv">3</span>,</span>
<span id="cb7-966"><a href="#cb7-966" aria-hidden="true" tabindex="-1"></a>        <span class="st">'max_cluster_size'</span>: <span class="dv">20</span></span>
<span id="cb7-967"><a href="#cb7-967" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb7-968"><a href="#cb7-968" aria-hidden="true" tabindex="-1"></a>    <span class="st">'intervention'</span>: {</span>
<span id="cb7-969"><a href="#cb7-969" aria-hidden="true" tabindex="-1"></a>        <span class="st">'num_rounds'</span>: <span class="dv">5</span>,</span>
<span id="cb7-970"><a href="#cb7-970" aria-hidden="true" tabindex="-1"></a>        <span class="st">'interventions_per_round'</span>: <span class="dv">5</span>,</span>
<span id="cb7-971"><a href="#cb7-971" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cascade_max_hops'</span>: <span class="dv">3</span></span>
<span id="cb7-972"><a href="#cb7-972" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-973"><a href="#cb7-973" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-974"><a href="#cb7-974" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-975"><a href="#cb7-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-976"><a href="#cb7-976" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.2 Best Practices</span></span>
<span id="cb7-977"><a href="#cb7-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-978"><a href="#cb7-978" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb7-979"><a href="#cb7-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-980"><a href="#cb7-980" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preparation</span></span>
<span id="cb7-981"><a href="#cb7-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-982"><a href="#cb7-982" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Normalize temporal profiles to zero mean, unit variance</span>
<span id="cb7-983"><a href="#cb7-983" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ensure building features include energy label, area, roof capacity</span>
<span id="cb7-984"><a href="#cb7-984" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Validate LV group assignments match physical network</span>
<span id="cb7-985"><a href="#cb7-985" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Include at least 96 timesteps (4 days) for pattern detection</span>
<span id="cb7-986"><a href="#cb7-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-987"><a href="#cb7-987" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Training</span></span>
<span id="cb7-988"><a href="#cb7-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-989"><a href="#cb7-989" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Start with Discovery Trainer for unsupervised exploration</span>
<span id="cb7-990"><a href="#cb7-990" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use Network-Aware Trainer when intervention data available</span>
<span id="cb7-991"><a href="#cb7-991" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Apply gradient clipping (max norm = 1.0) for stability</span>
<span id="cb7-992"><a href="#cb7-992" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Monitor complementarity scores - should trend negative</span>
<span id="cb7-993"><a href="#cb7-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-994"><a href="#cb7-994" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hyperparameter Tuning</span></span>
<span id="cb7-995"><a href="#cb7-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-996"><a href="#cb7-996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Hidden dimension: 128-256 for ~1000 buildings</span>
<span id="cb7-997"><a href="#cb7-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Attention heads: 8 for complementarity, 4 for temporal</span>
<span id="cb7-998"><a href="#cb7-998" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Learning rate: 1e-3 with cosine annealing</span>
<span id="cb7-999"><a href="#cb7-999" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dropout: 0.1-0.2 for regularization</span>
<span id="cb7-1000"><a href="#cb7-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1001"><a href="#cb7-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deployment</span></span>
<span id="cb7-1002"><a href="#cb7-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1003"><a href="#cb7-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Validate physics constraints before deployment</span>
<span id="cb7-1004"><a href="#cb7-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check cluster sizes remain within operational limits</span>
<span id="cb7-1005"><a href="#cb7-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Monitor cascade predictions against real interventions</span>
<span id="cb7-1006"><a href="#cb7-1006" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Update model quarterly with new consumption data</span>
<span id="cb7-1007"><a href="#cb7-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1008"><a href="#cb7-1008" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-1009"><a href="#cb7-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1010"><a href="#cb7-1010" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-1011"><a href="#cb7-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1012"><a href="#cb7-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10. Conclusions and Future Work</span></span>
<span id="cb7-1013"><a href="#cb7-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1014"><a href="#cb7-1014" aria-hidden="true" tabindex="-1"></a><span class="fu">### 10.1 Summary of Achievements</span></span>
<span id="cb7-1015"><a href="#cb7-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1016"><a href="#cb7-1016" aria-hidden="true" tabindex="-1"></a>The Energy GNN system successfully integrates:</span>
<span id="cb7-1017"><a href="#cb7-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1018"><a href="#cb7-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pattern Discovery**: Identifies complementary consumption patterns without labels</span>
<span id="cb7-1019"><a href="#cb7-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Network Awareness**: Respects grid topology and physical constraints</span>
<span id="cb7-1020"><a href="#cb7-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Multi-objective Optimization**: Balances competing goals effectively</span>
<span id="cb7-1021"><a href="#cb7-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Intervention Planning**: Predicts cascade effects for strategic deployment</span>
<span id="cb7-1022"><a href="#cb7-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1023"><a href="#cb7-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">### 10.2 Performance Summary</span></span>
<span id="cb7-1024"><a href="#cb7-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1027"><a href="#cb7-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-1028"><a href="#cb7-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: performance-summary</span></span>
<span id="cb7-1029"><a href="#cb7-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Overall System Performance"</span></span>
<span id="cb7-1030"><a href="#cb7-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1031"><a href="#cb7-1031" aria-hidden="true" tabindex="-1"></a>performance_data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb7-1032"><a href="#cb7-1032" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Metric'</span>: [<span class="st">'Clustering Accuracy'</span>, <span class="st">'Physics Compliance'</span>, <span class="st">'Prediction RMSE'</span>, </span>
<span id="cb7-1033"><a href="#cb7-1033" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Intervention Success'</span>, <span class="st">'Computational Efficiency'</span>],</span>
<span id="cb7-1034"><a href="#cb7-1034" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Score'</span>: [<span class="dv">92</span>, <span class="dv">98</span>, <span class="fl">0.12</span>, <span class="dv">85</span>, <span class="dv">78</span>],</span>
<span id="cb7-1035"><a href="#cb7-1035" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Target'</span>: [<span class="dv">90</span>, <span class="dv">95</span>, <span class="fl">0.15</span>, <span class="dv">80</span>, <span class="dv">75</span>],</span>
<span id="cb7-1036"><a href="#cb7-1036" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Category'</span>: [<span class="st">'Quality'</span>, <span class="st">'Constraint'</span>, <span class="st">'Accuracy'</span>, <span class="st">'Effectiveness'</span>, <span class="st">'Efficiency'</span>]</span>
<span id="cb7-1037"><a href="#cb7-1037" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-1038"><a href="#cb7-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1039"><a href="#cb7-1039" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb7-1040"><a href="#cb7-1040" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Bar(name<span class="op">=</span><span class="st">'Achieved'</span>, x<span class="op">=</span>performance_data[<span class="st">'Metric'</span>], </span>
<span id="cb7-1041"><a href="#cb7-1041" aria-hidden="true" tabindex="-1"></a>                     y<span class="op">=</span>performance_data[<span class="st">'Score'</span>],</span>
<span id="cb7-1042"><a href="#cb7-1042" aria-hidden="true" tabindex="-1"></a>                     marker_color<span class="op">=</span><span class="st">'lightgreen'</span>))</span>
<span id="cb7-1043"><a href="#cb7-1043" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Bar(name<span class="op">=</span><span class="st">'Target'</span>, x<span class="op">=</span>performance_data[<span class="st">'Metric'</span>], </span>
<span id="cb7-1044"><a href="#cb7-1044" aria-hidden="true" tabindex="-1"></a>                     y<span class="op">=</span>performance_data[<span class="st">'Target'</span>],</span>
<span id="cb7-1045"><a href="#cb7-1045" aria-hidden="true" tabindex="-1"></a>                     marker_color<span class="op">=</span><span class="st">'lightblue'</span>))</span>
<span id="cb7-1046"><a href="#cb7-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1047"><a href="#cb7-1047" aria-hidden="true" tabindex="-1"></a>fig.update_layout(title<span class="op">=</span><span class="st">'System Performance vs Targets'</span>,</span>
<span id="cb7-1048"><a href="#cb7-1048" aria-hidden="true" tabindex="-1"></a>                  yaxis_title<span class="op">=</span><span class="st">'Score/Performance'</span>,</span>
<span id="cb7-1049"><a href="#cb7-1049" aria-hidden="true" tabindex="-1"></a>                  barmode<span class="op">=</span><span class="st">'group'</span>,</span>
<span id="cb7-1050"><a href="#cb7-1050" aria-hidden="true" tabindex="-1"></a>                  height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-1051"><a href="#cb7-1051" aria-hidden="true" tabindex="-1"></a>fig.show()</span>
<span id="cb7-1052"><a href="#cb7-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1053"><a href="#cb7-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1054"><a href="#cb7-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">### 10.3 Future Directions</span></span>
<span id="cb7-1055"><a href="#cb7-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1056"><a href="#cb7-1056" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb7-1057"><a href="#cb7-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recommended Enhancements</span></span>
<span id="cb7-1058"><a href="#cb7-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1059"><a href="#cb7-1059" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Temporal Dynamics**: Incorporate seasonal patterns and weather dependencies</span>
<span id="cb7-1060"><a href="#cb7-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Heterogeneous Networks**: Extend to mixed residential/commercial buildings</span>
<span id="cb7-1061"><a href="#cb7-1061" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Real-time Adaptation**: Online learning for dynamic network conditions</span>
<span id="cb7-1062"><a href="#cb7-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Explainability**: Enhanced visualization of decision rationale</span>
<span id="cb7-1063"><a href="#cb7-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Scalability**: Distributed training for city-scale deployments</span>
<span id="cb7-1064"><a href="#cb7-1064" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-1065"><a href="#cb7-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1066"><a href="#cb7-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">### 10.4 Code Repository Structure</span></span>
<span id="cb7-1067"><a href="#cb7-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1068"><a href="#cb7-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1069"><a href="#cb7-1069" aria-hidden="true" tabindex="-1"></a><span class="in">energy-gnn/</span></span>
<span id="cb7-1070"><a href="#cb7-1070" aria-hidden="true" tabindex="-1"></a><span class="in">├── training/</span></span>
<span id="cb7-1071"><a href="#cb7-1071" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── discovery_trainer.py       # Unsupervised discovery</span></span>
<span id="cb7-1072"><a href="#cb7-1072" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── network_aware_trainer.py   # Network-constrained training</span></span>
<span id="cb7-1073"><a href="#cb7-1073" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── unified_gnn_trainer.py     # Multi-task training</span></span>
<span id="cb7-1074"><a href="#cb7-1074" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── enhanced_trainer.py        # Advanced features</span></span>
<span id="cb7-1075"><a href="#cb7-1075" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── loss_functions.py          # Core loss implementations</span></span>
<span id="cb7-1076"><a href="#cb7-1076" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── network_aware_loss.py      # Network-specific losses</span></span>
<span id="cb7-1077"><a href="#cb7-1077" aria-hidden="true" tabindex="-1"></a><span class="in">│</span></span>
<span id="cb7-1078"><a href="#cb7-1078" aria-hidden="true" tabindex="-1"></a><span class="in">├── models/</span></span>
<span id="cb7-1079"><a href="#cb7-1079" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── attention_layers.py        # Complementarity attention</span></span>
<span id="cb7-1080"><a href="#cb7-1080" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── temporal_layers.py         # Time-series processing</span></span>
<span id="cb7-1081"><a href="#cb7-1081" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── physics_layers.py          # Physics constraints</span></span>
<span id="cb7-1082"><a href="#cb7-1082" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── network_aware_layers.py    # Grid-aware layers</span></span>
<span id="cb7-1083"><a href="#cb7-1083" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── pooling_layers.py          # Hierarchical clustering</span></span>
<span id="cb7-1084"><a href="#cb7-1084" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── explainability_layers.py   # Interpretation modules</span></span>
<span id="cb7-1085"><a href="#cb7-1085" aria-hidden="true" tabindex="-1"></a><span class="in">│</span></span>
<span id="cb7-1086"><a href="#cb7-1086" aria-hidden="true" tabindex="-1"></a><span class="in">└── analysis/</span></span>
<span id="cb7-1087"><a href="#cb7-1087" aria-hidden="true" tabindex="-1"></a><span class="in">    ├── pattern_analyzer.py        # Pattern discovery</span></span>
<span id="cb7-1088"><a href="#cb7-1088" aria-hidden="true" tabindex="-1"></a><span class="in">    ├── intervention_recommender.py # Intervention planning</span></span>
<span id="cb7-1089"><a href="#cb7-1089" aria-hidden="true" tabindex="-1"></a><span class="in">    └── comprehensive_reporter.py   # Report generation</span></span>
<span id="cb7-1090"><a href="#cb7-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb7-1091"><a href="#cb7-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1092"><a href="#cb7-1092" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-1093"><a href="#cb7-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1094"><a href="#cb7-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix: Technical Details</span></span>
<span id="cb7-1095"><a href="#cb7-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1096"><a href="#cb7-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">### A. Loss Function Formulations</span></span>
<span id="cb7-1097"><a href="#cb7-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1098"><a href="#cb7-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Complementarity Loss</span></span>
<span id="cb7-1099"><a href="#cb7-1099" aria-hidden="true" tabindex="-1"></a>$$\mathcal{L}_{comp} = \frac{1}{K} \sum_{k=1}^{K} \frac{\sum_{i,j \in C_k} (\rho_{ij} + 1) \cdot S_{ik} \cdot S_{jk}}{\sum_{i,j \in C_k} S_{ik} \cdot S_{jk}}$$</span>
<span id="cb7-1100"><a href="#cb7-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1101"><a href="#cb7-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Energy Balance Loss</span></span>
<span id="cb7-1102"><a href="#cb7-1102" aria-hidden="true" tabindex="-1"></a>$$\mathcal{L}_{balance} = \frac{1}{N} \sum_{i=1}^{N} \left( D_i - G_i - \sum_{j} E_{ji} + \sum_{j} E_{ij} \right)^2$$</span>
<span id="cb7-1103"><a href="#cb7-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1104"><a href="#cb7-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Peak Reduction Loss</span></span>
<span id="cb7-1105"><a href="#cb7-1105" aria-hidden="true" tabindex="-1"></a>$$\mathcal{L}_{peak} = \max(0, \frac{P_{cluster}}{P_{individual}} - (1 - \tau))$$</span>
<span id="cb7-1106"><a href="#cb7-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1107"><a href="#cb7-1107" aria-hidden="true" tabindex="-1"></a>Where $\tau$ is the target reduction ratio (e.g., 0.25 for 25% reduction).</span>
<span id="cb7-1108"><a href="#cb7-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1109"><a href="#cb7-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">### B. Attention Mechanism Details</span></span>
<span id="cb7-1110"><a href="#cb7-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1111"><a href="#cb7-1111" aria-hidden="true" tabindex="-1"></a>The multi-head complementarity attention computes:</span>
<span id="cb7-1112"><a href="#cb7-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1113"><a href="#cb7-1113" aria-hidden="true" tabindex="-1"></a>$$\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}} + \mathbf{C}\right)V$$</span>
<span id="cb7-1114"><a href="#cb7-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1115"><a href="#cb7-1115" aria-hidden="true" tabindex="-1"></a>Where $\mathbf{C}$ is the complementarity matrix derived from temporal correlations.</span>
<span id="cb7-1116"><a href="#cb7-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1117"><a href="#cb7-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">### C. Computational Complexity</span></span>
<span id="cb7-1118"><a href="#cb7-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1119"><a href="#cb7-1119" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Component <span class="pp">|</span> Time Complexity <span class="pp">|</span> Space Complexity <span class="pp">|</span></span>
<span id="cb7-1120"><a href="#cb7-1120" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|----------------|------------------|</span></span>
<span id="cb7-1121"><a href="#cb7-1121" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Complementarity Attention <span class="pp">|</span> $O(N^2 \cdot d \cdot h)$ <span class="pp">|</span> $O(N^2 \cdot h)$ <span class="pp">|</span></span>
<span id="cb7-1122"><a href="#cb7-1122" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> DiffPool Clustering <span class="pp">|</span> $O(N^2 \cdot K)$ <span class="pp">|</span> $O(N \cdot K)$ <span class="pp">|</span></span>
<span id="cb7-1123"><a href="#cb7-1123" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Physics Constraints <span class="pp">|</span> $O(N^2)$ <span class="pp">|</span> $O(N^2)$ <span class="pp">|</span></span>
<span id="cb7-1124"><a href="#cb7-1124" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Cascade Prediction <span class="pp">|</span> $O(N \cdot E \cdot H)$ <span class="pp">|</span> $O(N \cdot H)$ <span class="pp">|</span></span>
<span id="cb7-1125"><a href="#cb7-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1126"><a href="#cb7-1126" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb7-1127"><a href="#cb7-1127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$N$: Number of nodes (buildings)</span>
<span id="cb7-1128"><a href="#cb7-1128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$d$: Feature dimension</span>
<span id="cb7-1129"><a href="#cb7-1129" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$h$: Number of attention heads</span>
<span id="cb7-1130"><a href="#cb7-1130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$K$: Number of clusters</span>
<span id="cb7-1131"><a href="#cb7-1131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$E$: Number of edges</span>
<span id="cb7-1132"><a href="#cb7-1132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$H$: Maximum hop distance</span>
<span id="cb7-1133"><a href="#cb7-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1134"><a href="#cb7-1134" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-1135"><a href="#cb7-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1136"><a href="#cb7-1136" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb7-1137"><a href="#cb7-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quick Start Guide</span></span>
<span id="cb7-1138"><a href="#cb7-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1139"><a href="#cb7-1139" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Install dependencies: <span class="in">`pip install -r requirements.txt`</span></span>
<span id="cb7-1140"><a href="#cb7-1140" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Load data: <span class="in">`python data/data_loader.py`</span></span>
<span id="cb7-1141"><a href="#cb7-1141" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Train model: <span class="in">`python main.py --mode train --config config/config.yaml`</span></span>
<span id="cb7-1142"><a href="#cb7-1142" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Analyze results: <span class="in">`python analysis/comprehensive_reporter.py`</span></span>
<span id="cb7-1143"><a href="#cb7-1143" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Generate interventions: <span class="in">`python analysis/intervention_recommender.py`</span></span>
<span id="cb7-1144"><a href="#cb7-1144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb7-1145"><a href="#cb7-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1146"><a href="#cb7-1146" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb7-1147"><a href="#cb7-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-1148"><a href="#cb7-1148" aria-hidden="true" tabindex="-1"></a>*This technical report provides a comprehensive analysis of the Energy GNN system's architecture, training strategies, and performance characteristics. For implementation details and code examples, refer to the associated repository.*</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>