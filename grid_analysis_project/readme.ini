## Grid Analysis Workflow Automation System

This Python-based automation system transforms a complex, manual PostgreSQL-based electrical grid analysis process into a streamlined, repeatable workflow. The system analyzes electrical infrastructure relationships between specified geographic areas, automatically processing the connections between buildings and the power grid hierarchy.

### Core Functionality

The system begins by accepting two building IDs (OGC FIDs) and a unique prefix identifier. These buildings serve as diagonal corners of a bounding box that defines the analysis area. Rather than manually executing SQL scripts and managing table names, the automation handles the entire workflow programmatically, ensuring consistency and preventing naming conflicts through intelligent prefix management.

### Workflow Orchestration

The analysis proceeds through six sequential stages, each building upon the previous results:

**1. Data Clipping**: The system creates a geographic bounding box between the two specified buildings and clips all electrical infrastructure data to this area. This includes substations, transformers, distribution cabinets, and cables at high, medium, and low voltage levels, plus all buildings within the boundary.

**2. Cable Segmentation (Step 1)**: The clipped cable geometries are decomposed into individual segments, then grouped into connected components. This creates a network topology where electrically connected cables form distinct groups, essential for understanding power flow paths.

**3. Hierarchical Connections (Steps 2-3)**: The system establishes relationships between voltage levels, linking low-voltage groups to medium-voltage networks through transformers, and medium-voltage to high-voltage through substations. This creates a complete hierarchical tree structure of the electrical grid.

**4. Building Connections (Steps 4-8)**: Each building is connected to its nearest appropriate electrical infrastructure. The system determines connection types (direct cable entry, proximity-based, or problematic distant connections), identifies buildings capable of medium-voltage connections, and flags potential issues where buildings are too far from infrastructure.

**5. Grid Summary**: Comprehensive statistics are generated, showing the hierarchical organization from substations down to individual buildings, including connection quality metrics and load distribution patterns.

**6. MV-LV Analysis**: Advanced analysis identifies optimal locations for energy communities, areas needing infrastructure intervention, and patterns of complementary energy usage between residential and commercial buildings.

### Intelligent Table Management

The automatic table naming system. All SQL scripts reference standard table names prefixed with "tlip_", but the system dynamically replaces these with user-defined prefixes at runtime. This means the same SQL files can be reused for multiple analysis runs without modification. For example, "tlip_cable_segments" becomes "project1_s1_cable_segments" for one run and "test_area_s1_cable_segments" for another.

### Operational Benefits

The automation provides multiple execution modes: interactive prompts for casual users, command-line parameters for scripting, batch processing for multiple areas, and a test mode for validation. Comprehensive logging tracks every operation, making debugging straightforward and providing audit trails for regulatory compliance.

By reducing a multi-hour manual process to minutes of automated execution, the system enables rapid iteration for infrastructure planning, facilitates comparative analysis across different areas, and ensures reproducible results for research validation. The prefix-based organization allows multiple analyses to coexist in the same database, supporting parallel investigations and historical comparisons.

This transformation from manual SQL execution to automated workflow represents a significant advancement in electrical grid analysis efficiency, enabling planners and researchers to focus on interpreting results rather than managing complex database operations.